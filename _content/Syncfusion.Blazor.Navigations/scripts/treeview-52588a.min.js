!function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s="./bundles/treeview.js")}({"./bundles/treeview.js":function(e,t,s){"use strict";s.r(t);s("./modules/treeview.js");s.p="_content/Syncfusion.Blazor.Navigations/scripts/"},"./modules/treeview.js":function(e,t){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.navigations=sf.base.extend({},sf.navigations,function(e){"use strict";var t,i=(t=function(e,s){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,s)},function(e,s){function i(){this.constructor=e}t(e,s),e.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}),a=function(e,t,i,a){var n,d=arguments.length,r=d<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"===("undefined"==typeof Reflect?"undefined":s(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(r=(d<3?n(r):d>3?n(t,i,r):n(t,i))||r);return d>3&&r&&Object.defineProperty(t,i,r),r},n="e-treeview",d="e-icon-collapsible",r="e-icon-expandable",l="e-list-item",o="e-list-text",h="e-list-parent",c="e-hover",f="e-active",p="e-icons-spinner",u="e-process",g="e-icons",b="e-text-content",v="e-sibling",N="e-drop-next",m="e-selected",y="e-check",C="e-checkbox-wrapper",k="e-node-focus",x={treeRole:"tree",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),a([sf.base.Property("child")],t.prototype,"child",void 0),a([sf.base.Property([])],t.prototype,"dataSource",void 0),a([sf.base.Property("expanded")],t.prototype,"expanded",void 0),a([sf.base.Property("hasChildren")],t.prototype,"hasChildren",void 0),a([sf.base.Property("htmlAttributes")],t.prototype,"htmlAttributes",void 0),a([sf.base.Property("iconCss")],t.prototype,"iconCss",void 0),a([sf.base.Property("id")],t.prototype,"id",void 0),a([sf.base.Property("imageUrl")],t.prototype,"imageUrl",void 0),a([sf.base.Property("isChecked")],t.prototype,"isChecked",void 0),a([sf.base.Property("parentID")],t.prototype,"parentID",void 0),a([sf.base.Property(null)],t.prototype,"query",void 0),a([sf.base.Property("selected")],t.prototype,"selected",void 0),a([sf.base.Property(null)],t.prototype,"tableName",void 0),a([sf.base.Property("text")],t.prototype,"text",void 0),a([sf.base.Property("tooltip")],t.prototype,"tooltip",void 0),a([sf.base.Property("navigateUrl")],t.prototype,"navigateUrl",void 0),t}(sf.base.ChildProperty),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),a([sf.base.Property("SlideDown")],t.prototype,"effect",void 0),a([sf.base.Property(400)],t.prototype,"duration",void 0),a([sf.base.Property("linear")],t.prototype,"easing",void 0),t}(sf.base.ChildProperty),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),a([sf.base.Complex({effect:"SlideUp",duration:400,easing:"linear"},O)],t.prototype,"collapse",void 0),a([sf.base.Complex({effect:"SlideDown",duration:400,easing:"linear"},O)],t.prototype,"expand",void 0),t}(sf.base.ChildProperty),E=function(e){function t(t,s){var i=e.call(this,t,s)||this;return i.isRefreshed=!1,i.preventExpand=!1,i.checkedElement=[],i.disableNode=[],i.validArr=[],i.expandChildren=[],i.isFieldChange=!1,i.changeDataSource=!1,i.isBlazorExpandedNodes=[],i.mouseDownStatus=!1,i}var O;return i(t,e),O=t,t.prototype.getModuleName=function(){return"treeview"},t.prototype.preRender=function(){var e=this;this.isBlazorPlatform=sf.base.isBlazor()&&this.isServerRendered,this.checkActionNodes=[],this.parentNodeCheck=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:r,ariaAttributes:x,expandIconPosition:"Left",itemCreated:function(t){e.beforeNodeCreate(t)},enableHtmlSanitizer:this.enableHtmlSanitizer,itemNavigable:this.fullRowNavigable},this.updateListProp(this.fields),this.aniObj=new sf.base.Animation({}),this.treeList=[],this.isLoaded=!1,this.isInitalExpand=!1,this.expandChildren=[],this.index=0,this.setTouchClass(),sf.base.isNullOrUndefined(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),sf.base.isNullOrUndefined(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0),sf.base.isNullOrUndefined(this.expandedNodes)?this.setProperties({expandedNodes:[]},!0):this.isInitalExpand=!0},t.prototype.getPersistData=function(){return this.addOnPersist(["selectedNodes","checkedNodes","expandedNodes"])},t.prototype.render=function(){this.initialRender=!0,this.blazorInitialRender=!1,this.initialize(),this.setDataBinding(!1),this.setDisabledMode(),this.setExpandOnType(),this.disabled||this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.disabled||this.wireEvents(),this.isBlazorPlatform||(this.initialRender=!1),this.renderComplete()},t.prototype.initialize=function(){this.isBlazorPlatform||(this.element.setAttribute("role","tree"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect)),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},t.prototype.setDisabledMode=function(){this.disabled?this.element.classList.add("e-disabled"):this.element.classList.remove("e-disabled")},t.prototype.setEnableRtl=function(){this.enableRtl?sf.base.addClass([this.element],"e-rtl"):sf.base.removeClass([this.element],"e-rtl")},t.prototype.setRipple=function(){var e={selector:".e-fullrow,.e-text-content",ignore:"."+b+" > ."+g+",.e-input-group,.e-input, ."+C};this.rippleFn=sf.base.rippleEffect(this.element,e);var t={selector:"."+b+" > ."+g,isCenterRipple:!0};this.rippleIconFn=sf.base.rippleEffect(this.element,t)},t.prototype.setFullRow=function(e){e?sf.base.addClass([this.element],"e-fullrow-wrap"):sf.base.removeClass([this.element],"e-fullrow-wrap")},t.prototype.setMultiSelect=function(e){var t=sf.base.select("."+h,this.element);e?t.setAttribute("aria-multiselectable","true"):t.removeAttribute("aria-multiselectable")},t.prototype.templateComplier=function(e){if(e){this.element.classList.add("e-interaction");try{if(document.querySelectorAll(e).length)return sf.base.compile(document.querySelector(e).innerHTML.trim())}catch(t){return sf.base.compile(e)}}this.element.classList.remove("e-interaction")},t.prototype.setDataBinding=function(e){var t=this;this.treeList.push("false"),this.fields.dataSource instanceof sf.data.DataManager?(this.isOffline=this.isBlazorPlatform?this.fields.dataSource.offline:this.fields.dataSource.dataSource.offline,this.fields.dataSource.ready?this.fields.dataSource.ready.then((function(e){t.isOffline=t.isBlazorPlatform?t.fields.dataSource.offline:t.fields.dataSource.dataSource.offline,t.fields.dataSource instanceof sf.data.DataManager&&t.isOffline&&(t.treeList.pop(),t.treeData=e.result,t.isNumberTypeId=t.getType(),t.setRootData(),t.renderItems(!0),0!==t.treeList.length||t.isLoaded||t.finalize())})).catch((function(e){t.trigger("actionFailure",{error:e})})):this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then((function(s){t.treeList.pop(),t.treeData=s.result,t.isNumberTypeId=t.getType(),t.setRootData(),e&&(t.changeDataSource=!0),t.renderItems(!0),t.changeDataSource=!1,0!==t.treeList.length||t.isLoaded||t.finalize()})).catch((function(e){t.trigger("actionFailure",{error:e})}))):(this.treeList.pop(),sf.base.isNullOrUndefined(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=JSON.parse(JSON.stringify(this.fields.dataSource)),this.setRootData()),this.isNumberTypeId=this.getType(),this.renderItems(!1)),0!==this.treeList.length||this.isLoaded||this.finalize()},t.prototype.getQuery=function(e,t){void 0===t&&(t=null);var s,i=[];if(e.query)s=e.query.clone();else{s=new sf.data.Query;for(var a=this.getActualProperties(e),n=0,d=Object.keys(a);n<d.length;n++){var r=d[n];"dataSource"!==r&&"tableName"!==r&&"child"!==r&&e[r]&&"url"!==r&&-1===i.indexOf(e[r])&&i.push(e[r])}s.select(i),a.hasOwnProperty("tableName")&&s.from(e.tableName)}return sf.lists.ListBase.addSorting(this.sortOrder,e.text,s),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e.parentID)||s.where(e.parentID,"equal",this.isNumberTypeId?parseFloat(t):t),s},t.prototype.getType=function(){return!!this.treeData[0]&&"number"==typeof sf.base.getValue(this.fields.id,this.treeData[0])},t.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),1===this.dataType){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var e=this.getChildNodes(this.treeData,void 0,!0);sf.base.isNullOrUndefined(e)?this.rootData=[]:this.rootData=e}else this.rootData=this.treeData},t.prototype.renderItems=function(e){if(!this.isBlazorPlatform||this.isBlazorPlatform&&this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName||this.changeDataSource){this.listBaseOption.ariaAttributes.level=1;var t=this.getSortedData(this.rootData);this.ulElement=sf.lists.ListBase.createList(this.createElement,e?this.rootData:t,this.listBaseOption),this.element.appendChild(this.ulElement);var s=this.ulElement.querySelectorAll(".e-list-item");if(!1===this.loadOnDemand)for(var i=0;i<s.length;)this.renderChildNodes(s[i],!0,null,!0),i++;(1===sf.base.selectAll("."+h,this.element).length&&s&&0!==s.length||this.loadOnDemand)&&this.finalizeNode(this.element)}this.updateTemplateForBlazor(),this.parentNodeCheck=[],this.parentCheckData=[],this.updateCheckedStateFromDS(),this.autoCheck&&this.showCheckBox&&!this.isLoaded&&this.updateParentCheckState()},t.prototype.updateTemplateForBlazor=function(){this.nodeTemplate&&this.isBlazorPlatform&&!this.isStringTemplate&&this.updateBlazorTemplate()},t.prototype.updateCheckedStateFromDS=function(e){if(this.treeData&&this.showCheckBox)if(1===this.dataType){for(var t=this.fields,s=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(t.isChecked,"equal",!0,!1)),i=0;i<s.length;i++){var a=s[i][this.fields.id]?s[i][this.fields.id].toString():null;s[i][this.fields.parentID]&&s[i][this.fields.parentID].toString();if(-1!==this.checkedNodes.indexOf(a)||this.isLoaded||this.checkedNodes.push(a),s[i][this.fields.hasChildren])for(var n=s[i][this.fields.id],d=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(t.parentID,"equal",n,!1)),r=0;r<d.length;r++){var l=d[r][this.fields.id]?d[r][this.fields.id].toString():null;-1===this.checkedNodes.indexOf(l)&&this.autoCheck&&this.checkedNodes.push(l)}}for(i=0;i<this.checkedNodes.length;i++){var o=this.fields,h=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(o.id,"equal",this.checkedNodes[i],!0));h[0]&&this.autoCheck&&(this.getCheckedNodeDetails(o,h),this.checkIndeterminateState(h[0]));for(var c=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(o.parentID,"equal",this.checkedNodes[i],!0)),f=0;f<c.length;f++){var p=c[f][this.fields.id]?c[f][this.fields.id].toString():null;-1===this.checkedNodes.indexOf(p)&&this.autoCheck&&this.checkedNodes.push(p)}}}else if(2===this.dataType||this.fields.dataSource instanceof sf.data.DataManager&&this.isOffline)for(f=0;f<this.treeData.length;f++){var u=this.treeData[f][this.fields.id]?this.treeData[f][this.fields.id].toString():"";this.treeData[f][this.fields.isChecked]&&!this.isLoaded&&-1===this.checkedNodes.indexOf(u)&&this.checkedNodes.push(u);var g=sf.base.getValue(this.fields.child.toString(),this.treeData[f]);g&&this.updateChildCheckState(g,this.treeData[f])}},t.prototype.getCheckedNodeDetails=function(e,t){var s=t[0][this.fields.parentID]?t[0][this.fields.parentID].toString():null,i=0,a=this.element.querySelector('[data-uid="'+t[0][this.fields.id]+'"]'),n=this.element.querySelector('[data-uid="'+t[0][this.fields.parentID]+'"]');if(a||n){if(n){sf.base.select("."+y,n)||this.changeState(n,"indeterminate",null,!0,!0)}}else{this.parentNodeCheck.length;-1===this.parentNodeCheck.indexOf(s)&&this.parentNodeCheck.push(s);for(var d=this.getChildNodes(this.treeData,s),r=0;r<d.length;r++){var l=d[r][this.fields.id]?d[r][this.fields.id].toString():null;-1!==this.checkedNodes.indexOf(l)&&i++,i===d.length&&-1===this.checkedNodes.indexOf(s)&&this.checkedNodes.push(s)}var o=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(e.id,"equal",s,!0));this.getCheckedNodeDetails(e,o)}},t.prototype.updateParentCheckState=function(){for(var e,t=sf.base.selectAll(".e-stop",this.element),s=0;s<t.length;s++){var i=sf.base.closest(t[s],"."+l),a=i.getAttribute("data-uid").toString(),n=0;if(e=1===this.dataType?new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(this.fields.parentID,"equal",a,!0)):this.getChildNodes(this.treeData,a)){for(var d=0;d<e.length;d++){var r=e[d][this.fields.id].toString();-1!==this.checkedNodes.indexOf(r)&&n++}if(n===e.length){var o=i.getAttribute("data-uid");-1===this.checkedNodes.indexOf(o)&&this.checkedNodes.push(o),this.changeState(i,"check",null,!0,!0)}else 0===n&&0===this.checkedNodes.length&&this.changeState(i,"uncheck",null,!0,!0)}}},t.prototype.checkIndeterminateState=function(e){var t;if(t=1===this.dataType?this.element.querySelector('[data-uid="'+e[this.fields.parentID]+'"]'):this.element.querySelector('[data-uid="'+e[this.fields.id]+'"]'))"true"!==t.querySelector("."+C).getAttribute("aria-checked")&&this.changeState(t,"indeterminate",null,!0,!0);else if(2===this.dataType){this.parentNodeCheck.length;-1===this.parentNodeCheck.indexOf(e[this.fields.id].toString())&&this.parentNodeCheck.push(e[this.fields.id].toString())}},t.prototype.updateChildCheckState=function(e,t){for(var s=0,i=t[this.fields.id]?t[this.fields.id].toString():"",a=0;a<e.length;a++){var n=e[a][this.fields.id]?e[a][this.fields.id].toString():"";e[a][this.fields.isChecked]&&!this.isLoaded&&-1===this.checkedNodes.indexOf(n)&&this.checkedNodes.push(n),-1!==this.checkedNodes.indexOf(i)&&-1===this.checkedNodes.indexOf(n)&&this.autoCheck&&this.checkedNodes.push(n),-1!==this.checkedNodes.indexOf(n)&&this.autoCheck&&s++;var d=sf.base.getValue(this.fields.child.toString(),e[a]);d&&(this.parentCheckData.push(t),this.updateChildCheckState(d,e[a])),s===e.length&&this.autoCheck&&-1===this.checkedNodes.indexOf(i)&&this.checkedNodes.push(i)}if(0!==s&&this.autoCheck){this.checkIndeterminateState(t);for(var r=0;r<this.parentCheckData.length;r++)t!==this.parentCheckData[r]&&this.parentCheckData[r]&&this.checkIndeterminateState(this.parentCheckData[r])}this.parentCheckData=[]},t.prototype.beforeNodeCreate=function(e){if(this.showCheckBox){var t=sf.buttons.createCheckBox(this.createElement,!0,{cssClass:this.touchClass});t.setAttribute("role","checkbox");var s=sf.base.select("div."+g,e.item),i=e.item.getAttribute("data-uid");e.item.childNodes[0].insertBefore(t,e.item.childNodes[0].childNodes[sf.base.isNullOrUndefined(s)?0:1]);var a=sf.base.getValue(e.fields.isChecked,e.curData);this.checkedNodes.indexOf(i)>-1?(sf.base.select(".e-frame",t).classList.add(y),t.setAttribute("aria-checked","true"),this.addCheck(e.item)):sf.base.isNullOrUndefined(a)||"true"!==a.toString()?t.setAttribute("aria-checked","false"):(sf.base.select(".e-frame",t).classList.add(y),t.setAttribute("aria-checked","true"),this.addCheck(e.item));var n=sf.base.select(".e-frame",t);sf.base.EventHandler.add(n,"mousedown",this.frameMouseHandler,this),sf.base.EventHandler.add(n,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(e.item),this.allowMultiSelection&&!e.item.classList.contains(m)&&e.item.setAttribute("aria-selected","false");var d=e.fields;if(this.addActionClass(e,d.selected,m),this.addActionClass(e,d.expanded,"e-expanded"),!sf.base.isNullOrUndefined(this.nodeTemplateFn)){var r=e.item.querySelector("."+o),l=e.item.getAttribute("data-uid");r.innerHTML="",this.renderNodeTemplate(e.curData,r,l)}var h={node:e.item,nodeData:e.curData,text:e.text};this.isRefreshed||this.trigger("drawNode",h)},t.prototype.frameMouseHandler=function(e){var t=sf.base.select(".e-ripple-container",e.target.parentElement);sf.buttons.rippleMouseHandler(e,t)},t.prototype.addActionClass=function(e,t,s){var i=e.curData,a=sf.base.getValue(t,i);sf.base.isNullOrUndefined(a)||"false"===a.toString()||e.item.classList.add(s)},t.prototype.getDataType=function(e,t){if(this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName){for(var s=0;s<e.length;s++)if(this.isOffline){if("string"==typeof t.child&&sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[s]))&&!sf.base.isNullOrUndefined(sf.base.getValue(t.parentID,e[s])))return 1}else if("string"==typeof t.child&&sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[s])))return 1;return 2}s=0;for(var i=e.length;s<i;s++){if("string"==typeof t.child&&!sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[s])))return 2;if(!sf.base.isNullOrUndefined(sf.base.getValue(t.parentID,e[s]))||!sf.base.isNullOrUndefined(sf.base.getValue(t.hasChildren,e[s])))return 1}return 1},t.prototype.getGroupedData=function(e,t){for(var s=(new sf.data.Query).group(t),i=sf.lists.ListBase.getDataSource(e,s),a=[],n=0;n<i.length;n++){var d=i[n].items;a.push(d)}return a},t.prototype.getSortedData=function(e){return e&&"None"!==this.sortOrder&&(e=sf.lists.ListBase.getDataSource(e,sf.lists.ListBase.addSorting(this.sortOrder,this.fields.text))),e},t.prototype.finalizeNode=function(e){for(var t=sf.base.selectAll(".e-list-img",e),s=0;s<t.length;s++)t[s].setAttribute("alt","e-list-img");if(this.isLoaded){for(var i=sf.base.selectAll("."+m,e),a=0;a<i.length;a++){this.selectNode(i[a],null);break}sf.base.removeClass(i,m)}for(var n=sf.base.selectAll("."+l+":not(.e-expanded)",e),d=0;d<n.length;d++){var o=sf.base.select("div."+g,n[d]);o&&o.classList.contains(r)&&this.disableExpandAttr(n[d])}var h=sf.base.selectAll(".e-expanded",e);if(!this.isInitalExpand)for(a=0;a<h.length;a++)this.renderChildNodes(h[a]);sf.base.removeClass(h,"e-expanded"),this.updateList(),this.isLoaded&&this.updateCheckedProp()},t.prototype.updateCheckedProp=function(){if(this.showCheckBox){var e=[].concat([],this.checkedNodes);this.setProperties({checkedNodes:e},!0)}},t.prototype.ensureIndeterminate=function(){if(this.autoCheck)for(var e=sf.base.selectAll("li",this.element),t=0;t<e.length;t++)e[t].classList.contains(l)&&(sf.base.select("."+h,e[t])?this.ensureParentCheckState(e[t]):this.ensureChildCheckState(e[t]));else{var s=sf.base.selectAll(".e-stop",this.element);for(t=0;t<s.length;t++)s[t].classList.remove("e-stop")}},t.prototype.ensureParentCheckState=function(e){if(!sf.base.isNullOrUndefined(e)){if(e.classList.contains(n))return;var t=e;e.classList.contains(l)&&(t=sf.base.select("."+h,e));var s=sf.base.selectAll("."+y,t),i=sf.base.selectAll(".e-stop",t),a=sf.base.selectAll("."+l,t),d=e.getElementsByClassName(C)[0];a.length===s.length?this.changeState(d,"check",null,!0,!0):s.length>0||i.length>0?this.changeState(d,"indeterminate",null,!0,!0):0===s.length&&this.changeState(d,"uncheck",null,!0,!0);var r=sf.base.closest(e,"."+h);if(!sf.base.isNullOrUndefined(r)){var o=sf.base.closest(r,"."+l);this.ensureParentCheckState(o)}}},t.prototype.ensureChildCheckState=function(e,t){if(!sf.base.isNullOrUndefined(e)){var s=sf.base.select("."+h,e),i=void 0;if(!sf.base.isNullOrUndefined(s)){i=sf.base.selectAll("."+C,s);for(var a=e.getElementsByClassName("e-frame")[0].classList.contains(y),n=e.getElementsByClassName("e-frame")[0].classList.contains("e-stop"),d=s.querySelectorAll("li"),r=(s.parentElement.getAttribute("aria-expanded"),void 0),l=0;l<i.length;l++){var o=d[l].getAttribute("data-uid");if(sf.base.isNullOrUndefined(this.currentLoadData)||sf.base.isNullOrUndefined(sf.base.getValue(this.fields.isChecked,this.currentLoadData[l]))){var c=i[l].getElementsByClassName("e-frame")[0].classList.contains(y);a||c&&!this.isLoaded||-1!==this.checkedNodes.indexOf(o)&&this.isLoaded&&(n||a)?r="check":d[l].classList.contains("e-has-child")&&!sf.base.isUndefined(this.parentNodeCheck)&&this.autoCheck&&(a||n)&&-1!==this.parentNodeCheck.indexOf(o)||1===this.dataType&&!sf.base.isUndefined(this.parentNodeCheck)&&this.autoCheck&&(a||n)&&-1!==this.parentNodeCheck.indexOf(o)?(r="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(o),1)):r="uncheck"}else r=sf.base.getValue(this.fields.isChecked,this.currentLoadData[l])?"check":"uncheck",-1!==this.ele&&(r=a?"check":"uncheck"),"uncheck"===r&&!sf.base.isUndefined(this.parentNodeCheck)&&this.autoCheck&&-1!==this.parentNodeCheck.indexOf(o)&&(this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(o),1),r="indeterminate");this.changeState(i[l],r,t,!0,!0)}}this.autoCheck&&this.isLoaded&&this.updateParentCheckState()}},t.prototype.doCheckBoxAction=function(e,t){sf.base.selectAll("."+l,this.element);if(sf.base.isNullOrUndefined(e)){var s=sf.base.selectAll("."+C,this.element);if(this.loadOnDemand)for(var i=0;i<s.length;i++)this.updateFieldChecked(s[i],t),this.changeState(s[i],t?"check":"uncheck",null,null,null,t);else for(i=0;i<s.length;i++)this.updateFieldChecked(s[i],t),this.changeState(s[i],t?"check":"uncheck")}else for(var a=e.length;a>=0;a--){var n=void 0;if(n=1===e.length?this.getElement(e[a-1]):this.getElement(e[a]),sf.base.isNullOrUndefined(n)){var d=void 0;if(""!==(d=e[a-e.length]?e[a-e.length].toString():e[a]?e[a].toString():null)&&t&&d)this.setValidCheckedNode(d),this.dynamicCheckState(d,t);else if(-1!==this.checkedNodes.indexOf(d)&&""!==d&&!t){this.checkedNodes.splice(this.checkedNodes.indexOf(d),1);var r=this.getChildNodes(this.treeData,d);if(r){for(var o=0;o<r.length;o++){var c=r[o][this.fields.id]?r[o][this.fields.id].toString():null;-1!==this.checkedNodes.indexOf(c)&&this.checkedNodes.splice(this.checkedNodes.indexOf(c),1)}-1!==this.parentNodeCheck.indexOf(d)&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)}d&&this.dynamicCheckState(d,t),this.updateField(this.treeData,this.fields,d,"isChecked",null)}}else{var f=sf.base.select("."+h+" ."+C,n);this.validateCheckNode(f,!t,n,null)}}if(e)for(var p=0;p<e.length;p++){d=e[p]?e[p].toString():"";t||this.updateField(this.treeData,this.fields,d,"isChecked",null)}this.autoCheck&&this.updateParentCheckState()},t.prototype.updateFieldChecked=function(e,t){var s=sf.base.closest(e,"."+l),i=s.getAttribute("data-uid");"true"!==this.getNodeData(s).isChecked||t||this.updateField(this.treeData,this.fields,i,"isChecked",null)},t.prototype.dynamicCheckState=function(e,t){if(1===this.dataType){var s=0,i=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(this.fields.id,"equal",e,!0));if(i[0]){var a=i[0][this.fields.id]?i[0][this.fields.id].toString():null,n=i[0][this.fields.parentID]?i[0][this.fields.parentID].toString():null,d=((c=this.element.querySelector('[data-uid="'+n+'"]'))&&sf.base.select(".e-stop",c),c?sf.base.select("."+y,c):null),r=this.element.querySelector('[data-uid="'+a+'"]'),l=this.getChildNodes(this.treeData,n);if(l)for(var o=0;o<l.length;o++){var h=l[o][this.fields.id]?l[o][this.fields.id].toString():null;-1!==this.checkedNodes.indexOf(h)&&s++}-1!==this.checkedNodes.indexOf(e)&&c&&a===e&&this.autoCheck?this.changeState(c,"indeterminate",null):-1===this.checkedNodes.indexOf(e)&&r&&a===e&&!t?this.changeState(r,"uncheck",null):-1!==this.checkedNodes.indexOf(e)&&r&&a===e&&t?this.changeState(r,"check",null):-1===this.checkedNodes.indexOf(e)&&!r&&c&&a===e&&this.autoCheck&&0!==s?this.changeState(c,"indeterminate",null):-1===this.checkedNodes.indexOf(e)&&!r&&c&&a===e&&this.autoCheck&&0===s?this.changeState(c,"uncheck",null):r||c||a!==e||!this.autoCheck||this.updateIndeterminate(e,t)}}else if(2===this.dataType||this.fields.dataSource instanceof sf.data.DataManager&&this.isOffline){a=void 0;var c=void 0;for(d=void 0,o=0;o<this.treeData.length;o++){a=this.treeData[o][this.fields.id]?this.treeData[o][this.fields.id].toString():"",d=(c=this.element.querySelector('[data-uid="'+a+'"]'))?sf.base.select("."+y,c):null,-1===this.checkedNodes.indexOf(a)&&c&&d&&!t&&this.changeState(c,"uncheck",null);var f=sf.base.getValue(this.fields.child.toString(),this.treeData[o]);f&&this.updateChildIndeterminate(f,a,e,t,a)}}},t.prototype.updateIndeterminate=function(e,t){var s,i=this.getTreeData(e),a=0;1===this.dataType&&(s=i[0][this.fields.parentID]?i[0][this.fields.parentID].toString():null);var n=this.getChildNodes(this.treeData,s);if(n)for(var d=0;d<n.length;d++){var r=n[d][this.fields.id]?n[d][this.fields.id].toString():null;-1!==this.checkedNodes.indexOf(r)&&a++}var l=this.element.querySelector('[data-uid="'+s+'"]');l&&t||!t&&l&&-1===this.parentNodeCheck.indexOf(s)&&0!==a?this.changeState(l,"indeterminate",null):!t&&l&&-1===this.parentNodeCheck.indexOf(s)&&0===a?this.changeState(l,"uncheck",null):l||(t||-1!==this.checkedNodes.indexOf(s)||-1===this.parentNodeCheck.indexOf(s)?t&&-1===this.checkedNodes.indexOf(s)&&-1===this.parentNodeCheck.indexOf(s)?this.parentNodeCheck.push(s):t||-1===this.checkedNodes.indexOf(s)||-1!==this.parentNodeCheck.indexOf(s)||0===a||this.parentNodeCheck.push(s):this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(s),1),this.updateIndeterminate(s,t),-1===this.checkedNodes.indexOf(s)||t||this.checkedNodes.splice(this.checkedNodes.indexOf(s),1))},t.prototype.updateChildIndeterminate=function(e,t,s,i,a){for(var n=0,d=0;d<e.length;d++){var r=e[d][this.fields.id]?e[d][this.fields.id].toString():"";-1!==this.checkedNodes.indexOf(r)&&n++;var l=this.element.querySelector('[data-uid="'+t+'"]'),o=l?sf.base.select(".e-stop",l):null,h=l?sf.base.select("."+y,l):null,c=this.element.querySelector('[data-uid="'+r+'"]'),f=c?sf.base.select("."+y,c):null;if(-1!==this.checkedNodes.indexOf(s)&&l&&r===s&&this.autoCheck)this.changeState(l,"indeterminate",null);else if(-1!==this.checkedNodes.indexOf(s)||!l||c||r!==s||i){if(-1===this.checkedNodes.indexOf(s)&&c&&r===s&&!i)this.changeState(c,"uncheck",null);else if(-1===this.checkedNodes.indexOf(s)&&o&&r===s&&this.autoCheck&&0===n&&!i)o.classList.remove("e-stop");else if(-1===this.checkedNodes.indexOf(s)&&!c&&h&&r===s&&0===n)this.changeState(l,"uncheck",null);else if(-1===this.checkedNodes.indexOf(r)&&c&&f&&0===n)this.changeState(c,"uncheck",null);else if(!c&&!l&&r===s||-1!==this.parentNodeCheck.indexOf(t)&&this.autoCheck){var p=this.element.querySelector('[data-uid="'+a+'"]');i&&0!==n?this.changeState(p,"indeterminate",null):i&&n===e.length&&-1===this.checkedNodes.indexOf(t)?this.checkedNodes.push(t):i||0!==n||-1===this.parentNodeCheck.indexOf(t)||this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(t)),-1===this.parentNodeCheck.indexOf(t)&&this.parentNodeCheck.push(t)}}else this.autoCheck?this.changeState(l,"uncheck",null):0!==n?this.changeState(l,"indeterminate",null):this.changeState(l,"uncheck",null);var u=sf.base.getValue(this.fields.child.toString(),e[d]);u&&this.updateChildIndeterminate(u,r,s,i,a)}},t.prototype.changeState=function(e,t,s,i,a,n){var d,r=this,o=sf.base.closest(e,"."+l);i?this.nodeCheckAction(e,t,o,d,s,i,a,n):(this.checkActionNodes=[],d=this.getCheckEvent(o,t,s),this.trigger("nodeChecking",d,(function(d){d.cancel||r.nodeCheckAction(e,t,o,d,s,i,a,n)})))},t.prototype.nodeCheckAction=function(e,t,s,i,a,n,d,r){var l,o=e.getElementsByClassName("e-frame")[0];if("check"!==t||o.classList.contains(y)?"uncheck"===t&&(o.classList.contains(y)||o.classList.contains("e-stop"))?(sf.base.removeClass([o],[y,"e-stop"]),this.removeCheck(s),l="false"):"indeterminate"===t&&!o.classList.contains("e-stop")&&this.autoCheck&&(o.classList.remove(y),o.classList.add("e-stop"),this.removeCheck(s),l="mixed"):(o.classList.remove("e-stop"),o.classList.add(y),this.addCheck(s),l="true"),l="check"===t?"true":"uncheck"===t?"false":l,sf.base.isNullOrUndefined(l)||e.setAttribute("aria-checked",l),d){var h=[].concat([],this.checkActionNodes);i=this.getCheckEvent(s,t,a),sf.base.isUndefined(n)&&(i.data=h)}void 0!==r&&this.ensureStateChange(s,r),n||sf.base.isNullOrUndefined(l)||(e.setAttribute("aria-checked",l),this.allowServerDataBinding=!0,this.updateServerProperties("check"),this.allowServerDataBinding=!1,i.data[0].checked=l,this.trigger("nodeChecked",i),this.checkActionNodes=[])},t.prototype.addCheck=function(e){var t=e.getAttribute("data-uid");sf.base.isNullOrUndefined(t)||-1!==this.checkedNodes.indexOf(t)||this.checkedNodes.push(t)},t.prototype.removeCheck=function(e){var t=this.checkedNodes.indexOf(e.getAttribute("data-uid"));t>-1&&this.checkedNodes.splice(t,1)},t.prototype.getCheckEvent=function(e,t,s){this.checkActionNodes.push(this.getNodeData(e));var i=this.checkActionNodes;return{action:t,cancel:!1,isInteracted:!sf.base.isNullOrUndefined(s),node:e,data:i}},t.prototype.finalize=function(){var e=sf.base.select("."+h,this.element);if(!sf.base.isNullOrUndefined(e)){e.setAttribute("role",x.treeRole),this.setMultiSelect(this.allowMultiSelection);var t=sf.base.select("."+l,this.element);t&&(sf.base.addClass([t],k),this.updateIdAttr(null,t)),this.renderReactTemplates(),this.hasPid=!!this.rootData[0]&&this.rootData[0].hasOwnProperty(this.fields.parentID),this.doExpandAction()}},t.prototype.doExpandAction=function(){var e=this.expandedNodes;if(this.isInitalExpand&&e.length>0){if(this.setProperties({expandedNodes:[]},!0),this.isBlazorPlatform&&!this.initialRender)return;if(this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName)this.expandGivenNodes(e);else{for(var t=0;t<e.length;t++){var s=sf.base.select('[data-uid="'+e[t]+'"]',this.element);if(sf.base.isNullOrUndefined(s))e[t]&&-1===this.expandChildren.indexOf(e[t])&&this.expandChildren.push(e[t].toString());else{var i=sf.base.select("."+r,sf.base.select("."+b,s));sf.base.isNullOrUndefined(i)||this.expandAction(s,i,null)}}this.afterFinalized()}}else this.afterFinalized()},t.prototype.expandGivenNodes=function(e){var t=this;this.expandCallback(e[this.index],(function(){t.index++,t.index<e.length?t.expandGivenNodes(e):t.afterFinalized()}))},t.prototype.expandCallback=function(e,t){var s=sf.base.select('[data-uid="'+e+'"]',this.element);if(sf.base.isNullOrUndefined(s))t();else{var i=sf.base.select("."+r,sf.base.select("."+b,s));sf.base.isNullOrUndefined(i)?t():this.expandAction(s,i,null,!1,t)}},t.prototype.afterFinalized=function(){if((!this.isBlazorPlatform||this.isBlazorPlatform&&!this.initialRender)&&this.doSelectionAction(),this.updateCheckedProp(),this.isBlazorPlatform&&(this.initialRender&&this.setCheckedNodes(this.checkedNodes),this.updateInstance(),this.initialRender=!1),this.isAnimate=!0,this.isInitalExpand=!1,!this.isLoaded||this.isFieldChange){var e={data:this.treeData};this.trigger("dataBound",e)}this.isLoaded=!0},t.prototype.doSelectionAction=function(){var e=sf.base.selectAll("."+m,this.element),t=this.selectedNodes;if(t.length>0){this.setProperties({selectedNodes:[]},!0);for(var s=0;s<t.length;s++){var i=sf.base.select('[data-uid="'+t[s]+'"]',this.element);if(i&&!i.classList.contains("e-active")?this.selectNode(i,null,!0):this.selectedNodes.push(t[s]),!this.allowMultiSelection)break}}else this.selectGivenNodes(e);sf.base.removeClass(e,m)},t.prototype.selectGivenNodes=function(e){for(var t=0;t<e.length&&(e[t].classList.contains("e-disable")||this.selectNode(e[t],null,!0),this.allowMultiSelection);t++);},t.prototype.clickHandler=function(e){var t=e.originalEvent.target;if(sf.base.EventHandler.remove(this.element,"contextmenu",this.preventContextMenu),t&&!this.dragStartAction){var s=t.classList,i=sf.base.closest(t,"."+l);if(i){if(3!==e.originalEvent.which){var a=sf.base.select(".e-ripple-element",i),n=sf.base.select("."+g,i);if(this.removeHover(),this.setFocusElement(i),this.showCheckBox&&!i.classList.contains("e-disable")){var o=sf.base.closest(t,"."+C);if(!sf.base.isNullOrUndefined(o)){var c=sf.base.select(".e-frame",o);return this.validateCheckNode(o,c.classList.contains(y),i,e.originalEvent),void this.triggerClickEvent(e.originalEvent,i)}}s.contains(r)?this.expandAction(i,t,e):s.contains(d)?this.collapseNode(i,t,e):a&&n?n.classList.contains("e-ripple")&&n.classList.contains(r)?this.expandAction(i,n,e):n.classList.contains("e-ripple")&&n.classList.contains(d)?this.collapseNode(i,n,e):s.contains(h)||s.contains(l)||this.toggleSelect(i,e.originalEvent,!1):s.contains(h)||s.contains(l)||this.toggleSelect(i,e.originalEvent,!1)}this.triggerClickEvent(e.originalEvent,i)}}},t.prototype.nodeCheckedEvent=function(e,t,s){sf.base.closest(e,"."+l);var i=this.getCheckEvent(e,t?"uncheck":"check",s);i.data=i.data.splice(0,i.data.length-1),this.trigger("nodeChecked",i)},t.prototype.triggerClickEvent=function(e,t){var s={event:e,node:t};this.trigger("nodeClicked",s)},t.prototype.expandNode=function(e,t,s){var i=this;if(this.renderReactTemplates(),t.classList.contains(p)&&this.hideSpinner(t),this.initialRender||t.classList.add("interaction"),!0!==s||!0===s&&e.classList.contains("e-expanded")){if(!0!==this.preventExpand){sf.base.removeClass([t],r),sf.base.addClass([t],d);var a=0,n=0,o=this,c=sf.base.select("."+h,e),u=e;this.setHeight(u,c);var g=sf.base.select("."+l+"."+f,e);this.isAnimate&&!this.isRefreshed?this.aniObj.animate(c,{name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(t){u.style.overflow="hidden",!sf.base.isNullOrUndefined(g)&&g instanceof HTMLElement&&g.classList.add("e-animation-active"),a=u.offsetHeight,n=sf.base.select("."+b,e).offsetHeight},progress:function(e){e.element.style.display="block",o.animateHeight(e,a,n)},end:function(e){e.element.style.display="block",!sf.base.isNullOrUndefined(g)&&g instanceof HTMLElement&&g.classList.remove("e-animation-active"),i.expandedNode(u,c,t)}}):this.expandedNode(u,c,t)}}else sf.base.select("."+h,e).style.display="none",this.fields.dataSource instanceof sf.data.DataManager==!0&&(this.preventExpand=!1);this.initialRender&&t.classList.add("interaction")},t.prototype.expandedNode=function(e,t,s){t.style.display="block",e.style.display="block",e.style.overflow="",e.style.height="",sf.base.removeClass([s],u),this.addExpand(e),this.allowServerDataBinding=!0,this.updateServerProperties("expand"),this.allowServerDataBinding=!1,this.isLoaded&&this.expandArgs&&!this.isRefreshed&&(this.expandArgs=this.getExpandEvent(e,null),this.trigger("nodeExpanded",this.expandArgs))},t.prototype.addExpand=function(e){e.setAttribute("aria-expanded","true"),sf.base.removeClass([e],"e-node-collapsed");var t=e.getAttribute("data-uid");sf.base.isNullOrUndefined(t)||-1!==this.expandedNodes.indexOf(t)||this.expandedNodes.push(t)},t.prototype.collapseNode=function(e,t,s){var i,a=this;t.classList.contains(u)||(sf.base.addClass([t],u),this.isLoaded?(i=this.getExpandEvent(e,s),this.trigger("nodeCollapsing",i,(function(s){s.cancel?sf.base.removeClass([t],u):a.nodeCollapseAction(e,t,s)}))):this.nodeCollapseAction(e,t,i))},t.prototype.nodeCollapseAction=function(e,t,s){var i=this;sf.base.removeClass([t],d),sf.base.addClass([t],r);var a=0,n=0,o=this,c=sf.base.select("."+h,e),p=e,u=sf.base.select("."+l+"."+f,e);this.isAnimate?this.aniObj.animate(c,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(t){p.style.overflow="hidden",!sf.base.isNullOrUndefined(u)&&u instanceof HTMLElement&&u.classList.add("e-animation-active"),a=sf.base.select("."+b,e).offsetHeight,n=p.offsetHeight},progress:function(e){o.animateHeight(e,a,n)},end:function(e){e.element.style.display="none",!sf.base.isNullOrUndefined(u)&&u instanceof HTMLElement&&u.classList.remove("e-animation-active"),i.collapsedNode(p,c,t,s)}}):this.collapsedNode(p,c,t,s)},t.prototype.collapsedNode=function(e,t,s,i){t.style.display="none",e.style.overflow="",e.style.height="",sf.base.removeClass([s],u),this.allowServerDataBinding=!0,this.updateServerProperties("expand"),this.allowServerDataBinding=!1,this.removeExpand(e),this.isLoaded&&(i=this.getExpandEvent(e,null),this.trigger("nodeCollapsed",i))},t.prototype.removeExpand=function(e,t){t?e.removeAttribute("aria-expanded"):this.disableExpandAttr(e);var s=this.expandedNodes.indexOf(e.getAttribute("data-uid"));s>-1&&this.expandedNodes.splice(s,1)},t.prototype.disableExpandAttr=function(e){e.setAttribute("aria-expanded","false"),sf.base.addClass([e],"e-node-collapsed")},t.prototype.setHeight=function(e,t){t.style.display="block",t.style.visibility="hidden",e.style.height=e.offsetHeight+"px",t.style.display="none",t.style.visibility=""},t.prototype.animateHeight=function(e,t,s){var i=(s-t)*((e.duration-e.timeStamp)/e.duration)+t;e.element.parentElement.style.height=i+"px"},t.prototype.renderChildNodes=function(e,t,s,i){var a,n=this,d=sf.base.select("div."+g,e);if(!sf.base.isNullOrUndefined(d))if(this.showSpinner(d),this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName){var r=this.parents(e,"."+h).length,l=this.getChildFields(this.fields,r,1);if(sf.base.isNullOrUndefined(l)||sf.base.isNullOrUndefined(l.dataSource))return sf.base.detach(d),void this.removeExpand(e,!0);this.treeList.push("false"),this.fields.dataSource instanceof sf.data.DataManager&&this.isOffline?(this.treeList.pop(),a=this.getChildNodes(this.treeData,e.getAttribute("data-uid")),this.loadChild(a,l,d,e,t,s,i),this.updateTemplateForBlazor()):l.dataSource.executeQuery(this.getQuery(l,e.getAttribute("data-uid"))).then((function(r){n.treeList.pop(),a=r.result,1===n.dataType&&(n.dataType=2),n.loadChild(a,l,d,e,t,s,i),n.updateTemplateForBlazor()})).catch((function(e){n.trigger("actionFailure",{error:e})}))}else{if(a=this.getChildNodes(this.treeData,e.getAttribute("data-uid")),this.currentLoadData=a,sf.base.isNullOrUndefined(a)||0===a.length)return sf.base.detach(d),void this.removeExpand(e,!0);this.isBlazorPlatform&&this.initialRender||(this.listBaseOption.ariaAttributes.level=parseFloat(e.getAttribute("aria-level"))+1,e.appendChild(sf.lists.ListBase.createList(this.createElement,this.getSortedData(a),this.listBaseOption))),this.expandNode(e,d,i),this.setSelectionForChildNodes(a),this.ensureCheckNode(e),this.finalizeNode(e),this.loadOnDemand&&this.nodeTemplate&&this.isBlazorPlatform&&!this.isStringTemplate&&this.updateBlazorTemplate(),this.disableTreeNodes(a),this.renderSubChild(e,t,i)}},t.prototype.loadChild=function(e,t,s,i,a,n,d){if(this.currentLoadData=e,sf.base.isNullOrUndefined(e)||0===e.length)sf.base.detach(s),this.removeExpand(i,!0);else{if(this.updateListProp(t),this.fields.dataSource instanceof sf.data.DataManager&&!this.isOffline){var r=i.getAttribute("data-uid"),l=this.getNodeObject(r);sf.base.setValue("child",e,l)}this.listBaseOption.ariaAttributes.level=parseFloat(i.getAttribute("aria-level"))+1,i.appendChild(sf.lists.ListBase.createList(this.createElement,e,this.listBaseOption)),this.expandNode(i,s,d),this.setSelectionForChildNodes(e),this.ensureCheckNode(i),this.finalizeNode(i),this.disableTreeNodes(e),this.renderSubChild(i,a,d)}n&&n(),0!==this.treeList.length||this.isLoaded||this.finalize()},t.prototype.disableTreeNodes=function(e){for(var t=0;t<e.length;){var s=e[t][this.fields.id]?e[t][this.fields.id].toString():null;void 0!==this.disableNode&&-1!==this.disableNode.indexOf(s)&&this.doDisableAction([s]),t++}},t.prototype.setSelectionForChildNodes=function(e){var t;for(t=0;t<e.length;t++){var s=e[t][this.fields.id]?e[t][this.fields.id].toString():null;void 0!==this.selectedNodes&&-1!==this.selectedNodes.indexOf(s)&&this.doSelectionAction()}},t.prototype.ensureCheckNode=function(e){this.showCheckBox&&(this.ele=this.checkedElement?this.checkedElement.indexOf(e.getAttribute("data-uid")):null,this.autoCheck&&(this.ensureChildCheckState(e),this.ensureParentCheckState(e))),this.currentLoadData=null},t.prototype.getFields=function(e,t,s){return t===s?e:this.getFields(this.getChildMapper(e),t,s+1)},t.prototype.getChildFields=function(e,t,s){return t===s?this.getChildMapper(e):this.getChildFields(this.getChildMapper(e),t,s+1)},t.prototype.getChildMapper=function(e){return"string"==typeof e.child||sf.base.isNullOrUndefined(e.child)?e:e.child},t.prototype.getChildNodes=function(e,t,s){var i;if(void 0===s&&(s=!1),sf.base.isNullOrUndefined(e))return i;if(1===this.dataType)return this.getChildGroup(this.groupedData,t,s);if("string"==typeof this.fields.child)for(var a=0,n=e.length;a<n;a++){var d=sf.base.getValue(this.fields.id,e[a]);if(d&&d.toString()===t)return sf.base.getValue(this.fields.child,e[a]);if(!sf.base.isNullOrUndefined(sf.base.getValue(this.fields.child,e[a]))&&void 0!==(i=this.getChildNodes(sf.base.getValue(this.fields.child,e[a]),t)))break}return i},t.prototype.getChildGroup=function(e,t,s){if(!sf.base.isNullOrUndefined(e))for(var i=0,a=e.length;i<a;i++){if(sf.base.isNullOrUndefined(e[i][0])||sf.base.isNullOrUndefined(sf.base.getValue(this.fields.parentID,e[i][0])))return s?e[i]:[];if(sf.base.getValue(this.fields.parentID,e[i][0]).toString()===t)return e[i]}},t.prototype.renderSubChild=function(e,t,s){if(t)for(var i=sf.base.selectAll("."+r,e),a=0,n=i.length;a<n;a++){var d=i[a];if(e.querySelector(".e-icons")!==i[a]){var o=sf.base.closest(d,"."+l);this.expandArgs=this.getExpandEvent(o,null),!0!==s&&this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(o,t,null,s)}}},t.prototype.toggleSelect=function(e,t,s){e.classList.contains("e-disable")||(this.allowMultiSelection&&(t&&t.ctrlKey||s)&&this.isActive(e)?this.unselectNode(e,t):this.selectNode(e,t,s))},t.prototype.isActive=function(e){return!!e.classList.contains(f)},t.prototype.selectNode=function(e,t,s){var i,a=this;sf.base.isNullOrUndefined(e)||!this.allowMultiSelection&&this.isActive(e)&&!sf.base.isNullOrUndefined(t)?this.setFocusElement(e):this.isLoaded?(i=this.getSelectEvent(e,"select",t),this.trigger("nodeSelecting",i,(function(i){i.cancel||a.nodeSelectAction(e,t,i,s)}))):this.nodeSelectAction(e,t,i,s)},t.prototype.nodeSelectAction=function(e,t,s,i){if(this.allowMultiSelection&&(i||t&&(!t||t.ctrlKey))||this.removeSelectAll(),this.allowMultiSelection&&t&&t.shiftKey){this.startNode||(this.startNode=e);var a=this.liList.indexOf(this.startNode),n=this.liList.indexOf(e);if(a>n){var d=a;a=n,n=d}for(var r=a;r<=n;r++){var l=this.liList[r];sf.base.isVisible(l)&&!l.classList.contains("e-disable")&&this.addSelect(l)}}else this.startNode=e,this.addSelect(e);this.setFocusElement(e),this.isLoaded&&(this.allowServerDataBinding=!0,this.updateServerProperties("select"),this.allowServerDataBinding=!1,s.nodeData=this.getNodeData(e),this.trigger("nodeSelected",s))},t.prototype.unselectNode=function(e,t){var s,i=this;this.isLoaded?(s=this.getSelectEvent(e,"un-select",t),this.trigger("nodeSelecting",s,(function(t){t.cancel||(i.allowServerDataBinding=!0,i.updateServerProperties("select"),i.allowServerDataBinding=!1,i.nodeUnselectAction(e,t))}))):this.nodeUnselectAction(e,s)},t.prototype.nodeUnselectAction=function(e,t){this.removeSelect(e),this.setFocusElement(e),this.isLoaded&&(this.allowServerDataBinding=!0,this.updateServerProperties("select"),this.allowServerDataBinding=!1,t.nodeData=this.getNodeData(e),this.trigger("nodeSelected",t))},t.prototype.setFocusElement=function(e){if(!sf.base.isNullOrUndefined(e)){var t=this.getFocusedNode();t&&sf.base.removeClass([t],k),sf.base.addClass([e],k),this.updateIdAttr(t,e)}},t.prototype.addSelect=function(e){e.setAttribute("aria-selected","true"),sf.base.addClass([e],f);var t=e.getAttribute("data-uid");sf.base.isNullOrUndefined(t)||-1!==this.selectedNodes.indexOf(t)||this.selectedNodes.push(t)},t.prototype.removeSelect=function(e){this.allowMultiSelection?e.setAttribute("aria-selected","false"):e.removeAttribute("aria-selected"),sf.base.removeClass([e],f);var t=this.selectedNodes.indexOf(e.getAttribute("data-uid"));t>-1&&this.selectedNodes.splice(t,1)},t.prototype.removeSelectAll=function(){for(var e=this.element.querySelectorAll("."+f),t=0,s=e;t<s.length;t++){var i=s[t];this.allowMultiSelection?i.setAttribute("aria-selected","false"):i.removeAttribute("aria-selected")}sf.base.removeClass(e,f),this.setProperties({selectedNodes:[]},!0)},t.prototype.getSelectEvent=function(e,t,s){var i=this.getNodeData(e);return{action:t,cancel:!1,isInteracted:!sf.base.isNullOrUndefined(s),node:e,nodeData:i}},t.prototype.setExpandOnType=function(){this.expandOnType="Auto"===this.expandOn?sf.base.Browser.isDevice?"Click":"DblClick":this.expandOn},t.prototype.expandHandler=function(e){var t=e.originalEvent.target;!t||t.classList.contains("e-input")||t.classList.contains(n)||t.classList.contains(h)||t.classList.contains(l)||t.classList.contains(g)||this.showCheckBox&&sf.base.closest(t,"."+C)||this.expandCollapseAction(sf.base.closest(t,"."+l),e)},t.prototype.expandCollapseAction=function(e,t){var s=sf.base.select("div."+g,e);if(s&&!s.classList.contains(u)){var i=s.classList;i.contains(r)?this.expandAction(e,s,t):i.contains(d)&&this.collapseNode(e,s,t)}},t.prototype.expandAction=function(e,t,s,i,a){var n=this;t.classList.contains(u)||(sf.base.addClass([t],u),this.isLoaded&&!this.isRefreshed?(this.expandArgs=this.getExpandEvent(e,s),this.trigger("nodeExpanding",this.expandArgs,(function(s){s.cancel?sf.base.removeClass([t],u):n.nodeExpandAction(e,t,i,a)}))):this.nodeExpandAction(e,t,i,a))},t.prototype.nodeExpandAction=function(e,t,s,i){var a=sf.base.select("."+h,e);if(a&&"UL"===a.nodeName)this.expandNode(e,t);else{this.renderChildNodes(e,s,i);for(var n=sf.base.selectAll("."+l,e),d=0;d<n.length;d++){var o=this.getId(n[d]);if(-1!==this.expandChildren.indexOf(o)&&void 0!==this.expandChildren){var c=sf.base.select("."+r,sf.base.select("."+b,n[d]));sf.base.isNullOrUndefined(c)||this.expandAction(n[d],c,null),this.expandChildren.splice(this.expandChildren.indexOf(o),1)}}}},t.prototype.keyActionHandler=function(e){var t=this,s=e.target,i=this.getFocusedNode();if(s&&s.classList.contains("e-input")){var a=s;"enter"===e.action?(a.blur(),this.element.focus(),sf.base.addClass([i],c)):"escape"===e.action&&(a.value=this.oldText,a.blur(),this.element.focus(),sf.base.addClass([i],c))}else{e.preventDefault();var n={cancel:!1,event:e,node:i};this.trigger("keyPress",n,(function(s){if(!s.cancel)switch(e.action){case"space":t.showCheckBox&&t.checkNode(e);break;case"moveRight":t.openNode(!t.enableRtl,e);break;case"moveLeft":t.openNode(!!t.enableRtl,e);break;case"shiftDown":t.shiftKeySelect(!0,e);break;case"moveDown":case"ctrlDown":case"csDown":t.navigateNode(!0);break;case"shiftUp":t.shiftKeySelect(!1,e);break;case"moveUp":case"ctrlUp":case"csUp":t.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":t.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":t.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":t.toggleSelect(i,e);break;case"f2":t.allowEditing&&!i.classList.contains("e-disable")&&t.createTextbox(i,e);break;case"ctrlA":if(t.allowMultiSelection){var a=sf.base.selectAll("."+l+":not(."+f+")",t.element);t.selectGivenNodes(a)}}}))}},t.prototype.navigateToFocus=function(e){var t=this.getFocusedNode().querySelector("."+b),s=t.getBoundingClientRect(),i=this.getScrollParent(this.element);if(!sf.base.isNullOrUndefined(i)){var a=i.getBoundingClientRect();s.bottom>a.bottom?i.scrollTop+=s.bottom-a.bottom:s.top<a.top&&(i.scrollTop-=a.top-s.top)}this.isVisibleInViewport(t)||t.scrollIntoView(e)},t.prototype.isVisibleInViewport=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},t.prototype.getScrollParent=function(e){return sf.base.isNullOrUndefined(e)?null:e.scrollHeight>e.clientHeight?e:this.getScrollParent(e.parentElement)},t.prototype.shiftKeySelect=function(e,t){if(this.allowMultiSelection){var s=this.getFocusedNode(),i=e?this.getNextNode(s):this.getPrevNode(s);this.removeHover(),this.setFocusElement(i),this.toggleSelect(i,t,!1),this.navigateToFocus(!e)}else this.navigateNode(e)},t.prototype.checkNode=function(e){var t=this.getFocusedNode(),s=sf.base.select("."+C,t),i=sf.base.select(" .e-frame",s).classList.contains(y);t.classList.contains("e-disable")||0==t.getElementsByClassName("e-checkbox-disabled").length&&this.validateCheckNode(s,i,t,e)},t.prototype.validateCheckNode=function(e,t,s,i){var a=this,n=sf.base.closest(e,"."+l);this.checkActionNodes=[];var d=t?"false":"true";sf.base.isNullOrUndefined(d)||e.setAttribute("aria-checked",d);var r=this.getCheckEvent(n,t?"uncheck":"check",i);this.trigger("nodeChecking",r,(function(n){n.cancel||a.nodeCheckingAction(e,t,s,n,i)}))},t.prototype.nodeCheckingAction=function(e,t,s,i,a){if(-1===this.checkedElement.indexOf(s.getAttribute("data-uid"))){this.checkedElement.push(s.getAttribute("data-uid"));var n=this.getChildNodes(this.treeData,s.getAttribute("data-uid"));null!==n?this.allCheckNode(n,this.checkedElement,null,null,!1):n=null}if(this.changeState(e,t?"uncheck":"check",a,!0),this.autoCheck){this.ensureChildCheckState(s),this.ensureParentCheckState(sf.base.closest(sf.base.closest(s,"."+h),"."+l));var d=void 0;"check"===i.action?d=!0:"uncheck"===i.action&&(d=!1),this.ensureStateChange(s,d)}this.allowServerDataBinding=!0,this.updateServerProperties("check"),this.allowServerDataBinding=!1,this.nodeCheckedEvent(e,t,a)},t.prototype.ensureStateChange=function(e,t){var s=sf.base.select("."+h,e),i=e.getAttribute("data-uid"),a=this.fields;if(1===this.dataType&&this.autoCheck)for(var n=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(a.parentID,"equal",i,!0)),d=0;d<n.length;d++){var r=n[d][this.fields.id]?n[d][this.fields.id].toString():null,l=n[d][this.fields.isChecked]?n[d][this.fields.isChecked].toString():null;if(-1!==this.checkedNodes.indexOf(i)&&-1===this.checkedNodes.indexOf(r)){this.checkedNodes.push(r);var o=this.getChildNodes(this.treeData,r);this.getChildItems(o,t),-1!==this.parentNodeCheck.indexOf(r)&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r),1)}else if(-1===this.checkedNodes.indexOf(i)&&null===s&&-1!==this.checkedNodes.indexOf(r)){if(this.checkedNodes.splice(this.checkedNodes.indexOf(r),1),"true"===l&&this.updateField(this.treeData,this.fields,r,"isChecked",null),-1===this.checkedNodes.indexOf(i)&&null===s||-1!==this.parentNodeCheck.indexOf(r)){var c=this.getChildNodes(this.treeData,r);this.getChildItems(c,t),-1!==this.parentNodeCheck.indexOf(r)&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r),1)}}else{o=this.getChildNodes(this.treeData,r);this.getChildItems(o,t)}}else if(1!==this.dataType||this.autoCheck){(o=this.getChildNodes(this.treeData,i))&&this.childStateChange(o,i,s,t)}else if(t)for(d=0;d<this.treeData.length;d++){var f=this.treeData[d][this.fields.id]?this.treeData[d][this.fields.id].toString():null;-1===this.checkedNodes.indexOf(f)&&this.checkedNodes.push(f)}else{for(var p=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(a.isChecked,"equal",!0,!1)),d=0;d<p.length;d++){var u=p[d][this.fields.id]?p[d][this.fields.id].toString():null;-1!==this.checkedNodes.indexOf(u)&&this.checkedNodes.splice(this.checkedNodes.indexOf(u),1),this.updateField(this.treeData,this.fields,u,"isChecked",null)}this.checkedNodes=[]}},t.prototype.getChildItems=function(e,t){for(var s=0;s<e.length;s++){var i=e[s][this.fields.id]?e[s][this.fields.id].toString():null,a=e[s][this.fields.isChecked]?e[s][this.fields.isChecked].toString():null;-1===this.checkedNodes.indexOf(i)||t||this.checkedNodes.splice(this.checkedNodes.indexOf(i),1),-1===this.checkedNodes.indexOf(i)&&t&&this.checkedNodes.push(i),"true"!==a||t||this.updateField(this.treeData,this.fields,i,"isChecked",null);var n=this.getChildNodes(this.treeData,i);n.length>0&&this.getChildItems(n,t)}},t.prototype.childStateChange=function(e,t,s,i){for(var a=0;a<e.length;a++){var n=e[a][this.fields.id]?e[a][this.fields.id].toString():"",d=e[a][this.fields.isChecked]?e[a][this.fields.isChecked].toString():null;this.autoCheck?-1!==this.checkedNodes.indexOf(t)&&-1===this.checkedNodes.indexOf(n)?(this.checkedNodes.push(n),-1!==this.parentNodeCheck.indexOf(n)&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(n),1)):-1!==this.checkedNodes.indexOf(t)||-1===this.checkedNodes.indexOf(n)||i||(this.checkedNodes.splice(this.checkedNodes.indexOf(n),1),"true"===d&&this.updateField(this.treeData,this.fields,n,"isChecked",null)):this.autoCheck||(i?-1===this.checkedNodes.indexOf(n)&&this.checkedNodes.push(n):(-1!==this.checkedNodes.indexOf(n)&&this.checkedNodes.splice(this.checkedNodes.indexOf(n),1),this.updateField(this.treeData,this.fields,n,"isChecked",null),this.checkedNodes=[]));var r=this.getChildNodes([e[a]],n);r&&this.childStateChange(r,t,s,i)}},t.prototype.allCheckNode=function(e,t,s,i,a){if(e)for(var n=0;n<e.length;n++){var d=sf.base.getValue(this.fields.id,e[n]),r=this.element.querySelector('[data-uid="'+d+'"]');if(!1!==a&&-1===this.checkedElement.indexOf(d.toString())&&(null===r&&!sf.base.isNullOrUndefined(e[n][this.fields.isChecked])&&-1===t.indexOf(d.toString())||0===i||2===s)&&(!1!==e[n][this.fields.isChecked]||2===s?t.push(d.toString()):i=null,i=!1!==e[n][this.fields.isChecked]||2===s?0:null),-1===t.indexOf(d.toString())&&sf.base.isNullOrUndefined(s)&&t.push(d.toString()),!0===sf.base.getValue(this.fields.hasChildren,e[n])||sf.base.getValue(this.fields.child.toString(),e[n])){var l=sf.base.getValue(this.fields.id,e[n]),o=this.getChildNodes(this.treeData,l.toString());o&&(sf.base.isNullOrUndefined(a)?this.allCheckNode(o,t,s,i):this.allCheckNode(o,t,s,i,a),i=null)}i=null}},t.prototype.openNode=function(e,t){var s=this.getFocusedNode(),i=sf.base.select("div."+g,s);if(e){if(!i)return;i.classList.contains(r)?this.expandAction(s,i,t):this.focusNextNode(s,!0)}else if(i&&i.classList.contains(d))this.collapseNode(s,i,t);else{var a=sf.base.closest(sf.base.closest(s,"."+h),"."+l);if(!a)return;a.classList.contains("e-disable")||(this.setFocus(s,a),this.navigateToFocus(!0))}},t.prototype.navigateNode=function(e){var t=this.getFocusedNode();this.focusNextNode(t,e)},t.prototype.navigateRootNode=function(e){var t=this.getFocusedNode(),s=e?this.getRootNode():this.getEndNode();s.classList.contains("e-disable")||(this.setFocus(t,s),this.navigateToFocus(e))},t.prototype.getFocusedNode=function(){var e,t=sf.base.select("."+l+"."+k,this.element);return sf.base.isNullOrUndefined(t)&&(e=sf.base.select("."+l,this.element)),sf.base.isNullOrUndefined(t)?sf.base.isNullOrUndefined(e)?this.element.firstElementChild:e:t},t.prototype.focusNextNode=function(e,t){var s=t?this.getNextNode(e):this.getPrevNode(e);if(this.setFocus(e,s),this.navigateToFocus(!t),s.classList.contains("e-disable")){var i=s.lastChild;null==s.previousSibling&&s.classList.contains("e-level-1")?this.focusNextNode(s,!0):null==s.nextSibling&&s.classList.contains("e-node-collapsed")||null==s.nextSibling&&i.classList.contains("e-text-content")?this.focusNextNode(s,!1):this.focusNextNode(s,t)}},t.prototype.getNextNode=function(e){var t,s=this.liList.indexOf(e);do{if(s++,t=this.liList[s],sf.base.isNullOrUndefined(t))return e}while(!sf.base.isVisible(t));return t},t.prototype.getPrevNode=function(e){var t,s=this.liList.indexOf(e);do{if(s--,t=this.liList[s],sf.base.isNullOrUndefined(t))return e}while(!sf.base.isVisible(t));return t},t.prototype.getRootNode=function(){var e,t=0;do{e=this.liList[t],t++}while(!sf.base.isVisible(e));return e},t.prototype.getEndNode=function(){var e,t=this.liList.length-1;do{e=this.liList[t],t--}while(!sf.base.isVisible(e));return e},t.prototype.setFocus=function(e,t){sf.base.removeClass([e],[c,k]),t.classList.contains("e-disable")||(sf.base.addClass([t],[c,k]),this.updateIdAttr(e,t))},t.prototype.updateIdAttr=function(e,t){this.element.removeAttribute("aria-activedescendant"),e&&e.removeAttribute("id"),t.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},t.prototype.focusIn=function(){this.mouseDownStatus||sf.base.addClass([this.getFocusedNode()],c),this.mouseDownStatus=!1},t.prototype.focusOut=function(){sf.base.removeClass([this.getFocusedNode()],c)},t.prototype.onMouseOver=function(e){var t=e.target,s=t.classList,i=sf.base.closest(t,"."+l);!i||s.contains(h)||s.contains(l)?this.removeHover():i&&!i.classList.contains("e-disable")&&this.setHover(i)},t.prototype.setHover=function(e){e.classList.contains(c)||(this.removeHover(),sf.base.addClass([e],c))},t.prototype.onMouseLeave=function(e){this.removeHover()},t.prototype.removeHover=function(){var e=sf.base.selectAll("."+c,this.element);e&&e.length&&sf.base.removeClass(e,c)},t.prototype.getNodeData=function(e,t){if(!sf.base.isNullOrUndefined(e)&&e.classList.contains(l)&&!sf.base.isNullOrUndefined(sf.base.closest(e,".e-control"))&&sf.base.closest(e,".e-control").classList.contains(n)){var s=e.getAttribute("data-uid"),i=this.getText(e,t),a=sf.base.closest(e.parentNode,"."+l),d=a?a.getAttribute("data-uid"):null,r=e.classList.contains(f),o="true"===e.getAttribute("aria-expanded"),h=null!==e.getAttribute("aria-expanded");this.isBlazorPlatform&&(h="true"===e.getAttribute("aria-expanded")||null!=(e.querySelector(".e-icon-expandable")||e.querySelector(".e-icon-collapsible")));var c=null;return this.showCheckBox&&(c=sf.base.select("."+C,e).getAttribute("aria-checked")),{id:s,text:i,parentID:d,selected:r,expanded:o,isChecked:c,hasChildren:h}}return{id:"",text:"",parentID:"",selected:!1,expanded:!1,isChecked:"",hasChildren:!1}},t.prototype.getText=function(e,t){if(t){var s=this.getNodeObject(e.getAttribute("data-uid")),i=parseFloat(e.getAttribute("aria-level")),a=this.getFields(this.fields,i,1);return sf.base.getValue(a.text,s)}return sf.base.select("."+o,e).textContent},t.prototype.getExpandEvent=function(e,t){var s=this.getNodeData(e);return{cancel:!1,isInteracted:!sf.base.isNullOrUndefined(t),node:e,nodeData:s,event:t}},t.prototype.renderNodeTemplate=function(e,t,s){var i=this.nodeTemplateFn(e,this,"nodeTemplate"+s,this.element.id+"nodeTemplate",this.isStringTemplate,void 0,t);i&&(i=Array.prototype.slice.call(i),sf.base.append(i,t))},t.prototype.destroyTemplate=function(e){this.clearTemplate(["nodeTemplate"+e.getAttribute("data-uid")])},t.prototype.reRenderNodes=function(){this.updateListProp(this.fields),sf.base.resetBlazorTemplate(this.element.id+"nodeTemplate","NodeTemplate"),this.isBlazorPlatform?(this.ulElement=this.element.querySelector(".e-list-parent.e-ul"),this.ulElement.parentElement.removeChild(this.ulElement)):this.element.innerHTML="",sf.base.isNullOrUndefined(this.nodeTemplateFn)||this.clearTemplate(),this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[],expandedNodes:[]},!0),this.checkedElement=[],this.isLoaded=!1,this.setDataBinding(!0)},t.prototype.setCssClass=function(e,t){sf.base.isNullOrUndefined(e)||""===e||sf.base.removeClass([this.element],e.split(" ")),sf.base.isNullOrUndefined(t)||""===t||sf.base.addClass([this.element],t.split(" "))},t.prototype.editingHandler=function(e){var t=e.target;if(!(!t||t.classList.contains(n)||t.classList.contains(h)||t.classList.contains(l)||t.classList.contains(g)||t.classList.contains("e-input")||t.classList.contains("e-input-group"))){var s=sf.base.closest(t,"."+l);this.createTextbox(s,e)}},t.prototype.createTextbox=function(e,t){var s=this,i=sf.base.select(".e-tree-input",this.element);i&&i.blur();var a=sf.base.select("."+o,e);this.updateOldText(e);var n=this.createElement("input",{className:"e-tree-input",attrs:{value:this.oldText}}),d=this.getEditEvent(e,null,n.outerHTML);this.trigger("nodeEditing",d,(function(t){if(!t.cancel){var i="width:"+(a.offsetWidth+5)+"px";sf.base.addClass([e],"e-editing"),sf.base.isNullOrUndefined(s.nodeTemplateFn)||s.destroyTemplate(e),a.innerHTML=d.innerHtml;var n=sf.base.select(".e-tree-input",a);s.inputObj=sf.inputs.Input.createInput({element:n,properties:{enableRtl:s.enableRtl}},s.createElement),s.inputObj.container.setAttribute("style",i),n.focus();var r=n;r.setSelectionRange(0,r.value.length),s.wireInputEvents(n)}}))},t.prototype.updateOldText=function(e){var t=e.getAttribute("data-uid");this.editData=this.getNodeObject(t);var s=parseFloat(e.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,s,1),this.oldText=sf.base.getValue(this.editFields.text,this.editData)},t.prototype.inputFocusOut=function(e){if(sf.base.select(".e-tree-input",this.element)){var t=e.target,s=t.value,i=sf.base.closest(t,"."+o),a=sf.base.closest(t,"."+l);sf.base.detach(this.inputObj.container),this.fields.dataSource instanceof sf.data.DataManager&&!this.isOffline&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName?this.crudOperation("update",null,a,s,null,null,!0):this.appendNewText(a,i,s,!0)}},t.prototype.appendNewText=function(e,t,s,i){var a=this,n=this.getEditEvent(e,s,null);this.trigger("nodeEdited",n,(function(n){s=n.cancel?n.oldText:n.newText,a.updateText(e,t,s,i),n.oldText!==s&&a.triggerEvent()}))},t.prototype.updateText=function(e,t,s,i){var a=sf.base.setValue(this.editFields.text,s,this.editData);if(sf.base.isNullOrUndefined(this.nodeTemplateFn))t.innerText=s;else{t.innerText="";var n=e.getAttribute("data-uid");this.renderNodeTemplate(a,t,n),this.updateBlazorTemplate(),this.renderReactTemplates()}i&&(sf.base.removeClass([e],"e-editing"),t.focus())},t.prototype.getElement=function(e){return sf.base.isNullOrUndefined(e)?null:"string"==typeof e?this.element.querySelector('[data-uid="'+e+'"]'):"object"===s(e)?sf.base.getElement(e):null},t.prototype.getId=function(e){return sf.base.isNullOrUndefined(e)?null:"string"==typeof e?e:"object"===s(e)?sf.base.getElement(e).getAttribute("data-uid"):null},t.prototype.getEditEvent=function(e,t,s){return{cancel:!1,newText:t,node:e,nodeData:this.getNodeData(e),oldText:this.oldText,innerHtml:s}},t.prototype.getNodeObject=function(e){if(!sf.base.isNullOrUndefined(e)){if(1!==this.dataType)return this.getChildNodeObject(this.treeData,this.fields,e);for(var t=0,s=this.treeData.length;t<s;t++){var i=sf.base.getValue(this.fields.id,this.treeData[t]);if(!sf.base.isNullOrUndefined(this.treeData[t])&&!sf.base.isNullOrUndefined(i)&&i.toString()===e)return this.treeData[t]}}},t.prototype.getChildNodeObject=function(e,t,s){var i;if(sf.base.isNullOrUndefined(e))return i;for(var a=0,n=e.length;a<n;a++){var d=sf.base.getValue(t.id,e[a]);if(e[a]&&d&&d.toString()===s)return e[a];if("string"!=typeof t.child||sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[a]))){if(this.fields.dataSource instanceof sf.data.DataManager&&!sf.base.isNullOrUndefined(sf.base.getValue("child",e[a]))){if(void 0!==(i=this.getChildNodeObject(sf.base.getValue("child",e[a]),this.getChildMapper(t),s)))break}}else{var r=sf.base.getValue(t.child,e[a]);if(void 0!==(i=this.getChildNodeObject(r,this.getChildMapper(t),s)))break}}return i},t.prototype.setDragAndDrop=function(e){e&&!this.disabled?this.initializeDrag():this.destroyDrag()},t.prototype.initializeDrag=function(){var e,t=this,s=this;this.dragObj=new sf.base.Draggable(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragArea:this.dragArea,dragTarget:"."+b,helper:function(i){t.dragTarget=i.sender.target;var a=sf.base.closest(t.dragTarget,"."+n),d=sf.base.closest(t.dragTarget,"."+b);if(t.dragLi=sf.base.closest(t.dragTarget,"."+l),t.fullRowSelect&&!d&&t.dragTarget.classList.contains("e-fullrow")&&(d=t.dragTarget.nextElementSibling),!t.dragTarget||!i.element.isSameNode(a)||!d||t.dragTarget.classList.contains(n)||t.dragTarget.classList.contains(h)||t.dragTarget.classList.contains(l)||t.dragLi.classList.contains("e-disable"))return!1;var o=d.cloneNode(!0);if(sf.base.isNullOrUndefined(sf.base.select("div."+g,o))){var c=s.createElement("div",{className:g+" "+r});o.insertBefore(c,o.children[0])}var p="e-drag-item "+n+" "+t.cssClass+" "+(t.enableRtl?"e-rtl":"");(e=s.createElement("div",{className:p})).appendChild(o);var u=t.selectedNodes.length;if(u>1&&t.allowMultiSelection&&t.dragLi.classList.contains(f)){var v=s.createElement("span",{className:"e-drop-count",innerHTML:""+u});e.appendChild(v)}return document.body.appendChild(e),document.body.style.cursor="",t.dragData=t.getNodeData(t.dragLi),e},dragStart:function(s){sf.base.addClass([t.element],"e-dragging");var i,a=sf.base.closest(s.target,".e-list-item");a&&(i=parseInt(a.getAttribute("aria-level"),10));var n=t.getDragEvent(s.event,t,null,s.target,null,e,i);n.draggedNode.classList.contains("e-editing")?(t.dragObj.intDestroy(s.event),t.dragCancelAction(e)):t.trigger("nodeDragStart",n,(function(i){i.cancel?(t.dragObj.intDestroy(s.event),t.dragCancelAction(e)):t.dragStartAction=!0,sf.base.isBlazor()&&s.bindEvents(sf.base.getElement(s.dragElement))}))},drag:function(s){t.dragObj.setProperties({cursorAt:{top:!sf.base.isNullOrUndefined(s.event.targetTouches)||sf.base.Browser.isDevice?60:-20}}),t.dragAction(s,e)},dragStop:function(e){sf.base.removeClass([t.element],"e-dragging"),t.removeVirtualEle();var s=e.target,i=sf.base.closest(s,".e-droppable"),a=!0;s&&i||(sf.base.detach(e.helper),document.body.style.cursor="",a=!1);var n,d=sf.base.closest(s,".e-list-item");d&&(n=parseInt(d.getAttribute("aria-level"),10));var r=t.getDragEvent(e.event,t,s,s,null,e.helper,n);r.preventTargetExpand=!1,(t.isBlazorPlatform&&t.dragStartAction||!t.isBlazorPlatform)&&t.trigger("nodeDragStop",r,(function(s){t.dragParent=s.draggedParentNode,t.preventExpand=s.preventTargetExpand,s.cancel&&(e.helper.parentNode&&sf.base.detach(e.helper),document.body.style.cursor="",a=!1),t.dragStartAction=!1,t.isBlazorPlatform&&a&&t.dropAction(e,!0)}))}}),this.dropObj=new sf.base.Droppable(this.element,{out:function(e){sf.base.isNullOrUndefined(e)||e.target.classList.contains(v)||(document.body.style.cursor="not-allowed")},over:function(e){document.body.style.cursor=""},drop:function(e){t.isBlazorPlatform||t.dropAction(e)}})},t.prototype.dragCancelAction=function(e){sf.base.detach(e),sf.base.removeClass([this.element],"e-dragging"),this.dragStartAction=!1},t.prototype.dragAction=function(e,t){var s=sf.base.closest(e.target,".e-droppable"),i=sf.base.closest(e.target,"."+b),a=sf.base.select("div."+g,t);sf.base.removeClass([a],["e-drop-in",N,"e-drop-out","e-no-drop"]),this.removeVirtualEle(),document.body.style.cursor="";var o=e.target.classList;if(this.fullRowSelect&&!i&&!sf.base.isNullOrUndefined(o)&&o.contains("e-fullrow")&&(i=e.target.nextElementSibling),s){var h=sf.base.closest(e.target,"."+l),c=sf.base.closest(e.target,"."+C),f=sf.base.closest(e.target,"."+d),p=sf.base.closest(e.target,"."+r);if(!s.classList.contains(n)||i&&!h.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,h))if(h&&e&&!p&&!f&&e.event.offsetY<7&&!c||p&&e.event.offsetY<5||f&&e.event.offsetX<3){sf.base.addClass([a],N);var u=this.createElement("div",{className:v}),m=this.fullRowSelect?1:0;h.insertBefore(u,h.children[m])}else if(h&&e&&!p&&!f&&e.target.offsetHeight>0&&e.event.offsetY>e.target.offsetHeight-10&&!c||p&&e.event.offsetY>19||f&&e.event.offsetX>19){sf.base.addClass([a],N);u=this.createElement("div",{className:v}),m=this.fullRowSelect?2:1;h.insertBefore(u,h.children[m])}else sf.base.addClass([a],"e-drop-in");else"LI"!==e.target.nodeName||h.isSameNode(this.dragLi)||this.isDescendant(this.dragLi,h)?e.target.classList.contains(v)?sf.base.addClass([a],N):sf.base.addClass([a],"e-drop-out"):(sf.base.addClass([a],N),this.renderVirtualEle(e))}else sf.base.addClass([a],"e-no-drop"),document.body.style.cursor="not-allowed";var y,k=sf.base.closest(e.target,".e-list-item");k&&(y=parseInt(k.getAttribute("aria-level"),10));var x=this.getDragEvent(e.event,this,e.target,e.target,null,t,y);x.dropIndicator&&sf.base.removeClass([a],x.dropIndicator),this.trigger("nodeDragging",x),x.dropIndicator&&sf.base.addClass([a],x.dropIndicator)},t.prototype.dropAction=function(e,t){var s,i,a,d=e.event.offsetY,r=e.target,o=!1;a=t?e.element:e.dragData.draggable;for(var h=0;h<a.ej2_instances.length;h++)if(a.ej2_instances[h]instanceof O){s=a.ej2_instances[h];break}if(s&&s.dragTarget){var c=s.dragTarget,p=sf.base.closest(c,"."+l),u=sf.base.closest(r,"."+l);if(null==u&&r.classList.contains(n)&&(u=r.firstElementChild),t?sf.base.detach(e.helper):sf.base.detach(e.droppedElement),document.body.style.cursor="",!u||u.isSameNode(p)||this.isDescendant(p,u))return void(this.fields.dataSource instanceof sf.data.DataManager==!1&&(this.preventExpand=!1));if(s.allowMultiSelection&&p.classList.contains(f)){var g=sf.base.selectAll("."+f,s.element);if(e.target.offsetHeight<=33&&d>e.target.offsetHeight-10&&d>6)for(h=g.length-1;h>=0;h--)u.isSameNode(g[h])||this.isDescendant(g[h],u)||this.appendNode(r,g[h],u,e,s,d);else for(h=0;h<g.length;h++)u.isSameNode(g[h])||this.isDescendant(g[h],u)||this.appendNode(r,g[h],u,e,s,d)}else this.appendNode(r,p,u,e,s,d);i=parseInt(p.getAttribute("aria-level"),10),o=!0}this.fields.dataSource instanceof sf.data.DataManager==!1&&(this.preventExpand=!1),t?this.trigger("nodeDropped",this.getDragEvent(e.event,s,r,e.target,e.element,null,i,o)):this.trigger("nodeDropped",this.getDragEvent(e.event,s,r,e.target,e.dragData.draggedElement,null,i,o)),this.triggerEvent()},t.prototype.appendNode=function(e,t,s,i,a,l){var o=sf.base.closest(e,"."+C),h=sf.base.closest(i.target,"."+d),c=sf.base.closest(i.target,"."+r);t.classList.contains("e-disable")||o||!(c&&i.event.offsetY<5||h&&i.event.offsetX<3||c&&i.event.offsetY>19||h&&i.event.offsetX>19||!c&&!h)?this.dropAsChildNode(t,s,a,null,i,l,!0):"LI"===e.nodeName?this.dropAsSiblingNode(t,s,i,a):e.firstElementChild&&e.classList.contains(n)?"UL"===e.firstElementChild.nodeName&&this.dropAsSiblingNode(t,s,i,a):e.classList.contains("e-icon-collapsible")||e.classList.contains("e-icon-expandable")?this.dropAsSiblingNode(t,s,i,a):this.dropAsChildNode(t,s,a,null,i,l)},t.prototype.dropAsSiblingNode=function(e,t,s,i){var a,n=sf.base.closest(t,"."+h),d=sf.base.closest(e,"."+h),r=sf.base.closest(d,"."+l);if(s.target.offsetHeight>0&&s.event.offsetY>s.target.offsetHeight-2?a=!1:s.event.offsetY<2?a=!0:(s.target.classList.contains("e-icon-expandable")||s.target.classList.contains("e-icon-collapsible"))&&(s.event.offsetY<5||s.event.offsetX<3?a=!0:(s.event.offsetY>15||s.event.offsetX>17)&&(a=!1)),s.target.classList.contains("e-icon-expandable")||s.target.classList.contains("e-icon-collapsible")){var o=s.target.closest("li");n.insertBefore(e,a?o:o.nextElementSibling)}else n.insertBefore(e,a?s.target:s.target.nextElementSibling);this.moveData(e,t,n,a,i),this.updateElement(d,r),this.updateAriaLevel(e),i.element.id===this.element.id?this.updateList():(i.updateInstance(),this.updateInstance())},t.prototype.dropAsChildNode=function(e,t,s,i,a,n,d){var r=sf.base.closest(e,"."+h),o=sf.base.closest(r,"."+l),c=sf.base.closest(t,"."+h);if(a&&n<7&&!d)c.insertBefore(e,t),this.moveData(e,t,c,!0,s);else if(a&&a.target.offsetHeight>0&&n>a.target.offsetHeight-10&&!d)c.insertBefore(e,t.nextElementSibling),this.moveData(e,t,c,!1,s);else{var f=this.expandParent(t),p=f.childNodes[i];f.insertBefore(e,p),this.moveData(e,p,f,!0,s)}this.updateElement(r,o),this.updateAriaLevel(e),s.element.id===this.element.id?this.updateList():(s.updateInstance(),this.updateInstance())},t.prototype.moveData=function(e,t,s,i,a){var n=sf.base.closest(s,"."+l),d=this.getId(e),r=a.updateChildField(a.treeData,a.fields,d,null,null,!0),o=this.getId(t),h=this.getDataPos(this.treeData,this.fields,o),c=this.getId(n);if(1===this.dataType){this.updateField(this.treeData,this.fields,c,"hasChildren",!0);var f=sf.base.isNullOrUndefined(h)?this.treeData.length:i?h:h+1;if(sf.base.isNullOrUndefined(c)&&!this.hasPid)delete r[0][this.fields.parentID];else{var p=this.isNumberTypeId?parseFloat(c):c;sf.base.setValue(this.fields.parentID,p,r[0])}if(this.treeData.splice(f,0,r[0]),a.element.id!==this.element.id){var u=a.removeChildNodes(d);f++;for(var g=0,b=u.length;g<b;g++)this.treeData.splice(f,0,u[g]),f++;a.groupedData=a.getGroupedData(a.treeData,a.fields.parentID)}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.addChildData(this.treeData,this.fields,c,r,i?h:h+1)},t.prototype.expandParent=function(e){var t=sf.base.select("div."+g,e);t&&t.classList.contains(r)&&!0!==this.preventExpand&&this.expandAction(e,t,null);var s,i=sf.base.select("."+h,e);(!0===this.preventExpand&&!i&&t&&this.renderChildNodes(e),i=sf.base.select("."+h,e),sf.base.isNullOrUndefined(i)||!0!==this.preventExpand||(i.style.display="none"),sf.base.isNullOrUndefined(i)||!1!==this.preventExpand||(i.style.display="block"),sf.base.isNullOrUndefined(i)&&!0===this.preventExpand)&&(sf.base.isNullOrUndefined(t)&&sf.lists.ListBase.generateIcon(this.createElement,e,r,this.listBaseOption),(s=sf.base.select("div."+g,e))&&s.classList.add("e-icon-expandable"),i=sf.lists.ListBase.generateUL(this.createElement,[],null,this.listBaseOption),e.appendChild(i),s?sf.base.removeClass([s],d):sf.lists.ListBase.generateIcon(this.createElement,e,r,this.listBaseOption),e.setAttribute("aria-expanded","false"),i.style.display="none");sf.base.isNullOrUndefined(i)&&(this.trigger("nodeExpanding",this.getExpandEvent(e,null)),sf.base.isNullOrUndefined(t)&&sf.lists.ListBase.generateIcon(this.createElement,e,d,this.listBaseOption),(s=sf.base.select("div."+g,e))||(sf.lists.ListBase.generateIcon(this.createElement,e,d,this.listBaseOption),s=sf.base.select("div."+g,e)),sf.base.removeClass([s],r),i=sf.lists.ListBase.generateUL(this.createElement,[],null,this.listBaseOption),e.appendChild(i),this.addExpand(e),this.trigger("nodeExpanded",this.getExpandEvent(e,null)));return i},t.prototype.updateElement=function(e,t){if(t&&0===e.childElementCount){var s=sf.base.select("div."+g,t);sf.base.detach(e),sf.base.detach(s);var i=this.getId(t);this.updateField(this.treeData,this.fields,i,"hasChildren",!1),this.removeExpand(t,!0)}},t.prototype.updateAriaLevel=function(e){var t=this.parents(e,"."+h).length;e.setAttribute("aria-level",""+t),this.updateChildAriaLevel(sf.base.select("."+h,e),t+1)},t.prototype.updateChildAriaLevel=function(e,t){if(!sf.base.isNullOrUndefined(e))for(var s=e.childNodes,i=0,a=s.length;i<a;i++){var n=s[i];n.setAttribute("aria-level",""+t),this.updateChildAriaLevel(sf.base.select("."+h,n),t+1)}},t.prototype.renderVirtualEle=function(e){var t;e.event.offsetY>e.target.offsetHeight-2?t=!1:e.event.offsetY<2&&(t=!0);var s=this.createElement("div",{className:v}),i=this.fullRowSelect?t?1:2:t?0:1;e.target.insertBefore(s,e.target.children[i])},t.prototype.removeVirtualEle=function(){var e=sf.base.select("."+v);e&&sf.base.detach(e)},t.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},t.prototype.getDragEvent=function(e,t,s,i,a,d,r,o){var h=s?sf.base.closest(s,"."+l):null,c=h?this.getNodeData(h):null,f=t?t.dragLi:a,p=t?t.dragData:null,u=s?this.parents(s,"."+l):null,b=t.dragLi.parentElement,v=t.dragLi?sf.base.closest(b,"."+l):null,m=null,y=null,C=[N,"e-drop-in","e-drop-out","e-no-drop"],k=null,x=!0===o?f:h,S=x?sf.base.closest(x,".e-list-parent"):null,O=0,D=null;if(v=t.dragLi&&null===v?sf.base.closest(b,"."+n):v,v=!0===o?this.dragParent:v,d)for(;O<4;){if(sf.base.select("."+g,d).classList.contains(C[O])){k=C[O];break}O++}if(S){var E=0;for(O=0;O<S.childElementCount;O++){if(E=!0!==o&&S.children[O]===f&&h!==f?++E:E,!0!==o&&S.children[O].classList.contains("e-hover")){y=e.offsetY>=23?O+1:O;break}if(S.children[O]===x){e.offsetY,y=O;break}}y=0!==E?--y:y,D="e-drop-in"==k?"Inside":e.offsetY<7?"Before":"After"}if(s&&(m=0===u.length?null:s.classList.contains(l)?u[0]:u[1]),h===f&&(m=h),s&&i.offsetHeight<=33&&e.offsetY<i.offsetHeight-10&&e.offsetY>6&&(m=h,!0!==o)){r=++r;var A=m?sf.base.select(".e-list-parent",m):null;if(y=A?A.children.length:0,!(this.fields.dataSource instanceof sf.data.DataManager)&&null===A&&m){var L=m.hasAttribute("data-uid")?this.getChildNodes(this.fields.dataSource,m.getAttribute("data-uid").toString()):null;y=L?L.length:0}}return{cancel:!1,clonedNode:d,event:e,draggedNode:f,draggedNodeData:p,droppedNode:h,droppedNodeData:c,dropIndex:y,dropLevel:r,draggedParentNode:v,dropTarget:m,dropIndicator:k,target:i,position:D}},t.prototype.addFullRow=function(e){var t=this.liList.length;if(e)for(var s=0;s<t;s++)this.createFullRow(this.liList[s]);else for(s=0;s<t;s++){var i=sf.base.select(".e-fullrow",this.liList[s]);sf.base.detach(i)}},t.prototype.createFullRow=function(e){var t=this.createElement("div",{className:"e-fullrow"});e.insertBefore(t,e.childNodes[0])},t.prototype.addMultiSelect=function(e){if(e)for(var t=0,s=sf.base.selectAll("."+l+':not([aria-selected="true"])',this.element);t<s.length;t++){s[t].setAttribute("aria-selected","false")}else for(var i=0,a=sf.base.selectAll("."+l+'[aria-selected="false"]',this.element);i<a.length;i++){a[i].removeAttribute("aria-selected")}},t.prototype.collapseByLevel=function(e,t,s){if(t>0&&!sf.base.isNullOrUndefined(e))for(var i=this.getVisibleNodes(s,e.childNodes),a=0,n=i.length;a<n;a++){var r=i[a],l=sf.base.select("."+d,sf.base.select("."+b,r));sf.base.isNullOrUndefined(l)||this.collapseNode(r,l,null),this.collapseByLevel(sf.base.select("."+h,r),t-1,s)}},t.prototype.collapseAllNodes=function(e){for(var t=this.getVisibleNodes(e,sf.base.selectAll("."+d,this.element)),s=0,i=t.length;s<i;s++){var a=t[s],n=sf.base.closest(a,"."+l);this.collapseNode(n,a,null)}},t.prototype.expandByLevel=function(e,t,s){if(t>0&&!sf.base.isNullOrUndefined(e))for(var i=this.getVisibleNodes(s,e.childNodes),a=0,n=i.length;a<n;a++){var d=i[a],l=sf.base.select("."+r,sf.base.select("."+b,d));sf.base.isNullOrUndefined(l)||this.expandAction(d,l,null),this.expandByLevel(sf.base.select("."+h,d),t-1,s)}},t.prototype.expandAllNodes=function(e){for(var t=this.getVisibleNodes(e,sf.base.selectAll("."+r,this.element)),s=0,i=t.length;s<i;s++){var a=t[s],n=sf.base.closest(a,"."+l);this.expandAction(n,a,null,!0)}},t.prototype.getVisibleNodes=function(e,t){var s=Array.prototype.slice.call(t);if(e)for(var i=0;i<s.length;i++)sf.base.isVisible(s[i])||(s.splice(i,1),i--);return s},t.prototype.removeNode=function(e){var t=sf.base.closest(e,"."+h),s=sf.base.closest(t,"."+l);sf.base.isNullOrUndefined(this.nodeTemplateFn)||this.destroyTemplate(e),sf.base.detach(e),this.updateElement(t,s),this.updateInstance(),this.removeData(e)},t.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes(),this.updateExpandedNodes(),this.allowServerDataBinding=!1,this.updateServerProperties("expand"),this.updateServerProperties("check"),this.updateServerProperties("select"),this.allowServerDataBinding=!0},t.prototype.updateServerProperties=function(e){this.isBlazorPlatform&&("expand"==e?(this.isBlazorExpandedNodes=this.expandedNodes,this.setProperties({expandedNodes:[]},!0)):"check"==e?this.setProperties({checkedNodes:this.checkedNodes},!0):this.setProperties({selectedNodes:this.selectedNodes},!0))},t.prototype.updateList=function(){this.liList=Array.prototype.slice.call(sf.base.selectAll("."+l,this.element))},t.prototype.updateSelectedNodes=function(){if(!this.isBlazorPlatform||this.isBlazorPlatform&&!this.initialRender){this.setProperties({selectedNodes:[]},!0);var e=sf.base.selectAll("."+f,this.element);this.selectGivenNodes(e)}else if(this.isBlazorPlatform&&this.initialRender){e=sf.base.selectAll("."+f,this.element);for(var t=0;t<e.length;t++){var s=e[t].getAttribute("data-uid").toString();sf.base.isNullOrUndefined(s)||-1!==this.selectedNodes.indexOf(s)||this.selectedNodes.push(s)}}},t.prototype.updateExpandedNodes=function(){if(!this.isBlazorPlatform||this.isBlazorPlatform&&!this.initialRender){this.setProperties({expandedNodes:[]},!0);for(var e=0,t=(s=sf.base.selectAll('[aria-expanded="true"]',this.element)).length;e<t;e++)this.addExpand(s[e])}else if(this.isBlazorPlatform&&this.initialRender)for(var s=sf.base.selectAll('[aria-expanded="true"]',this.element),i=0;i<s.length;i++){var a=s[i].getAttribute("data-uid").toString();sf.base.isNullOrUndefined(a)||-1!==this.expandedNodes.indexOf(a)||this.expandedNodes.push(a)}},t.prototype.removeData=function(e){if(1===this.dataType){var t=new sf.data.DataManager(this.treeData),s=this.getId(e),i={},a=this.isNumberTypeId?parseFloat(s):s;i[this.fields.id]=a,t.remove(this.fields.id,i),this.removeChildNodes(s)}else{s=this.getId(e);this.updateChildField(this.treeData,this.fields,s,null,null,!0)}},t.prototype.removeChildNodes=function(e){var t=this.getChildGroup(this.groupedData,e,!1),s=[];if(t)for(var i=0,a=t.length;i<a;i++){var n=new sf.data.DataManager(this.treeData),d=sf.base.getValue(this.fields.id,t[i]).toString(),r={},l=this.isNumberTypeId?parseFloat(d):d;r[this.fields.id]=l;var o=n.remove(this.fields.id,r);s.push(o[0]),this.removeChildNodes(d)}return s},t.prototype.doGivenAction=function(e,t,s){for(var i=0,a=e.length;i<a;i++){var n=this.getElement(e[i]);if(!sf.base.isNullOrUndefined(n)){var d=sf.base.select("."+t,sf.base.select("."+b,n));sf.base.isNullOrUndefined(d)||(s?this.expandAction(n,d,null):this.collapseNode(n,d,null))}}},t.prototype.addGivenNodes=function(e,t,s,i,a){if(0!==e.length){var n=this.getSortedData(e),d=t?parseFloat(t.getAttribute("aria-level"))+1:1;i&&this.updateMapper(d);for(var r,l=sf.lists.ListBase.createListItemFromJson(this.createElement,n,this.listBaseOption,d),o=(r=a||(t?this.expandParent(t):sf.base.select("."+h,this.element))).childNodes[s],c=0;c<l.length;c++)r.insertBefore(l[c],o);this.nodeTemplate&&this.isBlazorPlatform&&!this.isStringTemplate&&this.updateBlazorTemplate();var f=this.getId(t);if(1===this.dataType){this.updateField(this.treeData,this.fields,f,"hasChildren",!0);for(var p=this.getId(o),u=sf.base.isNullOrUndefined(p)?this.treeData.length:this.getDataPos(this.treeData,this.fields,p),g=0;g<e.length;g++){if(!sf.base.isNullOrUndefined(f)){var b=this.isNumberTypeId?parseFloat(f):f;sf.base.setValue(this.fields.parentID,b,e[g])}this.treeData.splice(u,0,e[g]),u++}}else this.addChildData(this.treeData,this.fields,f,e,s);this.finalizeNode(r)}},t.prototype.updateMapper=function(e){var t=1===e?this.fields:this.getChildFields(this.fields,e-1,1);this.updateListProp(t)},t.prototype.updateListProp=function(e){var t=this.getActualProperties(e);this.listBaseOption.fields=t,this.listBaseOption.fields.url=t.hasOwnProperty("navigateUrl")?t.navigateUrl:"navigateUrl"},t.prototype.getDataPos=function(e,t,s){for(var i=null,a=0,n=e.length;a<n;a++){var d=sf.base.getValue(t.id,e[a]);if(e[a]&&d&&d.toString()===s)return a;if("string"!=typeof t.child||sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[a]))){if(this.fields.dataSource instanceof sf.data.DataManager&&!sf.base.isNullOrUndefined(sf.base.getValue("child",e[a]))){var r=sf.base.getValue("child",e[a]);if(null!==(i=this.getDataPos(r,this.getChildMapper(t),s)))break}}else{var l=sf.base.getValue(t.child,e[a]);if(null!==(i=this.getDataPos(l,this.getChildMapper(t),s)))break}}return i},t.prototype.addChildData=function(e,t,s,i,a){var n;if(sf.base.isNullOrUndefined(s)){a=sf.base.isNullOrUndefined(a)?e.length:a;for(var d=0,r=i.length;d<r;d++)e.splice(a,0,i[d]),a++;return n}for(var l=0,o=e.length;l<o;l++){var h=sf.base.getValue(t.id,e[l]);if(e[l]&&h&&h.toString()===s){if("string"==typeof t.child&&e[l].hasOwnProperty(t.child)&&null!==e[l][t.child]||this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName&&e[l].hasOwnProperty("child")){var c="string"==typeof t.child?t.child:"child",f=sf.base.getValue(c,e[l]);sf.base.isNullOrUndefined(f)&&(f=[]),a=sf.base.isNullOrUndefined(a)?f.length:a;for(d=0,r=i.length;d<r;d++)f.splice(a,0,i[d]),a++}else{c="string"==typeof t.child?t.child:"child";e[l][c]=i}return!0}if("string"!=typeof t.child||sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[l]))){if(this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName&&!sf.base.isNullOrUndefined(sf.base.getValue("child",e[l]))){f=sf.base.getValue("child",e[l]);if(void 0!==(n=this.addChildData(f,this.getChildMapper(t),s,i,a)))break}}else{var p=sf.base.getValue(t.child,e[l]);if(void 0!==(n=this.addChildData(p,this.getChildMapper(t),s,i,a)))break}}return n},t.prototype.doDisableAction=function(e){var t=this.nodeType(e),s=this.checkValidId(t);this.validArr=[];for(var i=0,a=s.length;i<a;i++){var n=s[i][this.fields.id].toString();n&&-1===this.disableNode.indexOf(n)&&this.disableNode.push(n);var d=this.getElement(n);d&&(d.setAttribute("aria-disabled","true"),sf.base.addClass([d],"e-disable"))}},t.prototype.doEnableAction=function(e){for(var t=this.nodeType(e),s=0,i=t.length;s<i;s++){var a=this.getElement(t[s]),n=t[s];n&&-1!==this.disableNode.indexOf(n)&&this.disableNode.splice(this.disableNode.indexOf(n),1),a&&(a.removeAttribute("aria-disabled"),sf.base.removeClass([a],"e-disable"))}},t.prototype.nodeType=function(e){for(var t=[],i=0,a=e.length;i<a;i++){var n=void 0;"string"==typeof e[i]?n=e[i]?e[i].toString():null:"object"===s(e[i])&&(n=e[i]?e[i].getAttribute("data-uid").toString():null),-1==t.indexOf(n)&&t.push(n)}return t},t.prototype.checkValidId=function(e){var t=this;if(1===this.dataType)this.validArr=this.treeData.filter((function(s){return-1!==e.indexOf(s[t.fields.id]?s[t.fields.id].toString():null)}));else if(2===this.dataType)for(var s=0;s<this.treeData.length;s++){var i=this.treeData[s][this.fields.id]?this.treeData[s][this.fields.id].toString():null;-1!==e.indexOf(i)&&this.validArr.push(this.treeData[s]);var a=sf.base.getValue(this.fields.child.toString(),this.treeData[s]);a&&this.filterNestedChild(a,e)}return this.validArr},t.prototype.filterNestedChild=function(e,t){for(var s=0;s<e.length;s++){var i=e[s][this.fields.id]?e[s][this.fields.id].toString():null;-1!==t.indexOf(i)&&this.validArr.push(e[s]);var a=sf.base.getValue(this.fields.child.toString(),e[s]);a&&this.filterNestedChild(a,t)}},t.prototype.setTouchClass=function(){var e=sf.base.closest(this.element,".e-bigger");this.touchClass=sf.base.isNullOrUndefined(e)?"":"e-small"},t.prototype.updatePersistProp=function(){this.removeField(this.treeData,this.fields,["selected","expanded"]);for(var e=this.selectedNodes,t=0,s=e.length;t<s;t++)this.updateField(this.treeData,this.fields,e[t],"selected",!0);var i=this.expandedNodes;this.isBlazorPlatform&&(i=this.isBlazorExpandedNodes);for(var a=0,n=i.length;a<n;a++)this.updateField(this.treeData,this.fields,i[a],"expanded",!0);if(this.showCheckBox){this.removeField(this.treeData,this.fields,["isChecked"]);var d=this.checkedNodes,r=0;for(n=d.length;r<n;r++)this.updateField(this.treeData,this.fields,d[r],"isChecked",!0)}},t.prototype.removeField=function(e,t,s){if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t))for(var i=0,a=e.length;i<a;i++){for(var n=0;n<s.length;n++){var d=this.getMapperProp(t,s[n]);sf.base.isNullOrUndefined(e[i][d])||delete e[i][d]}"string"!=typeof t.child||sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[i]))?this.fields.dataSource instanceof sf.data.DataManager&&!sf.base.isNullOrUndefined(sf.base.getValue("child",e[i]))&&this.removeField(sf.base.getValue("child",e[i]),this.getChildMapper(t),s):this.removeField(sf.base.getValue(t.child,e[i]),this.getChildMapper(t),s)}},t.prototype.getMapperProp=function(e,t){switch(t){case"selected":return sf.base.isNullOrUndefined(e.selected)?"selected":e.selected;case"expanded":return sf.base.isNullOrUndefined(e.expanded)?"expanded":e.expanded;case"isChecked":return sf.base.isNullOrUndefined(e.isChecked)?"isChecked":e.isChecked;case"hasChildren":return sf.base.isNullOrUndefined(e.hasChildren)?"hasChildren":e.hasChildren;default:return t}},t.prototype.updateField=function(e,t,s,i,a){if(!sf.base.isNullOrUndefined(s))if(1===this.dataType){var n=this.isNumberTypeId?parseFloat(s):s,d=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(t.id,"equal",n,!1));sf.base.setValue(this.getMapperProp(t,i),a,d[0])}else this.updateChildField(e,t,s,i,a)},t.prototype.updateChildField=function(e,t,s,i,a,n){var d;if(sf.base.isNullOrUndefined(e))return d;for(var r=0,l=e.length;r<l;r++){var o=sf.base.getValue(t.id,e[r]);if(e[r]&&o&&o.toString()===s)return n?d=e.splice(r,1):(sf.base.setValue(this.getMapperProp(t,i),a,e[r]),d=[]),d;if("string"!=typeof t.child||sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[r]))){if(this.fields.dataSource instanceof sf.data.DataManager&&!sf.base.isNullOrUndefined(sf.base.getValue("child",e[r]))){var h=sf.base.getValue("child",e[r]);if(void 0!==(d=this.updateChildField(h,this.getChildMapper(t),s,i,a,n)))break}}else{var c=sf.base.getValue(t.child,e[r]);if(void 0!==(d=this.updateChildField(c,this.getChildMapper(t),s,i,a,n)))break}}return d},t.prototype.triggerEvent=function(){this.updateTemplateForBlazor(),this.renderReactTemplates();var e={data:this.treeData};this.trigger("dataSourceChanged",e)},t.prototype.updateBlazorTemplate=function(){sf.base.updateBlazorTemplate(this.element.id+"nodeTemplate","NodeTemplate",this,!1)},t.prototype.clientUpdateInitial=function(){this.blazorInitialRender=!0},t.prototype.wireInputEvents=function(e){sf.base.EventHandler.add(e,"blur",this.inputFocusOut,this)},t.prototype.wireEditingEvents=function(e){var t=this;if(e&&!this.disabled){var s=this;this.touchEditObj=new sf.base.Touch(this.element,{tap:function(e){t.isDoubleTapped(e)&&2===e.tapCount&&(e.originalEvent.preventDefault(),s.editingHandler(e.originalEvent))}})}else this.touchEditObj&&this.touchEditObj.destroy()},t.prototype.wireClickEvent=function(e){if(e){var t=this;this.touchClickObj=new sf.base.Touch(this.element,{tap:function(e){t.clickHandler(e)}})}else this.touchClickObj&&this.touchClickObj.destroy()},t.prototype.wireExpandOnEvent=function(e){var t=this;if(e){var s=this;this.touchExpandObj=new sf.base.Touch(this.element,{tap:function(e){("Click"===t.expandOnType||"DblClick"===t.expandOnType&&t.isDoubleTapped(e)&&2===e.tapCount)&&3!==e.originalEvent.which&&s.expandHandler(e)}})}else this.touchExpandObj&&this.touchExpandObj.destroy()},t.prototype.mouseDownHandler=function(e){this.mouseDownStatus=!0,(e.shiftKey||e.ctrlKey)&&e.preventDefault(),e.ctrlKey&&this.allowMultiSelection&&sf.base.EventHandler.add(this.element,"contextmenu",this.preventContextMenu,this)},t.prototype.preventContextMenu=function(e){e.preventDefault()},t.prototype.wireEvents=function(){sf.base.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),"None"!==this.expandOnType&&this.wireExpandOnEvent(!0),sf.base.EventHandler.add(this.element,"focus",this.focusIn,this),sf.base.EventHandler.add(this.element,"blur",this.focusOut,this),sf.base.EventHandler.add(this.element,"mouseover",this.onMouseOver,this),sf.base.EventHandler.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),sf.base.EventHandler.remove(this.element,"focus",this.focusIn),sf.base.EventHandler.remove(this.element,"blur",this.focusOut),sf.base.EventHandler.remove(this.element,"mouseover",this.onMouseOver),sf.base.EventHandler.remove(this.element,"mouseout",this.onMouseLeave),this.disabled||this.keyboardModule.destroy()},t.prototype.parents=function(e,t){for(var s=[],i=e.parentNode;!sf.base.isNullOrUndefined(i);)sf.base.matches(i,t)&&s.push(i),i=i.parentNode;return s},t.prototype.isDoubleTapped=function(e){var t,s=e.originalEvent.target;return s&&e.tapCount&&(1===e.tapCount?this.firstTap=sf.base.closest(s,"."+l):2===e.tapCount&&(t=sf.base.closest(s,"."+l))),this.firstTap===t},t.prototype.isDescendant=function(e,t){for(var s=t.parentNode;!sf.base.isNullOrUndefined(s);){if(s===e)return!0;s=s.parentNode}return!1},t.prototype.showSpinner=function(e){sf.base.addClass([e],p),sf.popups.createSpinner({target:e,width:sf.base.Browser.isDevice?16:14},this.createElement),sf.popups.showSpinner(e)},t.prototype.hideSpinner=function(e){sf.popups.hideSpinner(e),e.innerHTML="",sf.base.removeClass([e],p)},t.prototype.setCheckedNodes=function(e){e=JSON.parse(JSON.stringify(e)),this.uncheckAll(this.checkedNodes),this.setIndeterminate(e),e.length>0&&this.checkAll(e)},t.prototype.setValidCheckedNode=function(e){if(1===this.dataType){var t=this.fields,s=new sf.data.DataManager(this.treeData).executeLocal((new sf.data.Query).where(t.id,"equal",e,!0));if(s[0]&&(this.setChildCheckState(s,e,s[0]),this.autoCheck)){for(var i=s[0][this.fields.parentID]?s[0][this.fields.parentID].toString():null,a=this.getChildNodes(this.treeData,i),n=0,d=0;d<a.length;d++){var r=a[d][this.fields.id].toString();-1!==this.checkedNodes.indexOf(r)&&n++}n===a.length&&-1===this.checkedNodes.indexOf(i)&&i&&this.checkedNodes.push(i)}}else if(2===this.dataType)for(var l=0;l<this.treeData.length;l++){if((this.treeData[l][this.fields.id]?this.treeData[l][this.fields.id].toString():"")===e&&-1===this.checkedNodes.indexOf(e)){this.checkedNodes.push(e);break}var o=sf.base.getValue(this.fields.child.toString(),this.treeData[l]);o&&this.setChildCheckState(o,e,this.treeData[l])}},t.prototype.setChildCheckState=function(e,t,s){var i,a=0;if(1===this.dataType){s&&(i=s[this.fields.id]?s[this.fields.id].toString():null);for(var n=0;n<e.length;n++){var d=e[n][this.fields.id]?e[n][this.fields.id].toString():null;s&&i&&this.autoCheck&&-1!==this.checkedNodes.indexOf(i)&&-1===this.checkedNodes.indexOf(d)&&this.checkedNodes.push(d),d===t&&-1===this.checkedNodes.indexOf(t)&&this.checkedNodes.push(t),(r=this.getChildNodes(this.treeData,d))&&this.setChildCheckState(r,t,s)}}else{s&&(i=s[this.fields.id]?s[this.fields.id].toString():"");for(n=0;n<e.length;n++){var r,l=e[n][this.fields.id]?e[n][this.fields.id].toString():"";s&&i&&this.autoCheck&&-1!==this.checkedNodes.indexOf(i)&&-1===this.checkedNodes.indexOf(l)&&this.checkedNodes.push(l),l===t&&-1===this.checkedNodes.indexOf(t)&&this.checkedNodes.push(t),(r=sf.base.getValue(this.fields.child.toString(),e[n]))&&this.setChildCheckState(r,t,e[n]),-1!==this.checkedNodes.indexOf(l)&&this.autoCheck&&a++,a===e.length&&-1===this.checkedNodes.indexOf(i)&&this.autoCheck&&this.checkedNodes.push(i)}}},t.prototype.setIndeterminate=function(e){for(var t=0;t<e.length;t++)this.setValidCheckedNode(e[t])},t.prototype.updatePosition=function(e,t,s,i){if(1===this.dataType){var a=this.getDataPos(this.treeData,this.fields,e);if(this.treeData.splice(a,1,t),s){this.removeChildNodes(e);for(var n=0;n<i.length;n++)this.treeData.splice(a,0,i[n]),a++}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.updateChildPosition(this.treeData,this.fields,e,[t],void 0)},t.prototype.updateChildPosition=function(e,t,s,i,a){for(var n,d=0,r=e.length;d<r;d++){var l=sf.base.getValue(t.id,e[d]);if(e[d]&&l&&l.toString()===s)return e[d]=i[0],!0;if("string"!=typeof t.child||sf.base.isNullOrUndefined(sf.base.getValue(t.child,e[d]))){if(this.fields.dataSource instanceof sf.data.DataManager&&!sf.base.isNullOrUndefined(sf.base.getValue("child",e[d]))){var o=sf.base.getValue("child",e[d]);if(void 0!==(n=this.updateChildPosition(o,this.getChildMapper(t),s,i,a)))break}}else{var h=sf.base.getValue(t.child,e[d]);if(void 0!==(n=this.updateChildPosition(h,this.getChildMapper(t),s,i,a)))break}}return n},t.prototype.dynamicState=function(){this.setDragAndDrop(this.allowDragAndDrop),this.wireEditingEvents(this.allowEditing),this.disabled?(this.unWireEvents(),this.rippleFn(),this.rippleIconFn()):(this.wireEvents(),this.setRipple())},t.prototype.crudOperation=function(e,t,i,a,n,d,r){var l,o=this,h=this.fields.dataSource,c=[],f=this.getQuery(this.fields),p=this.fields.id,u={addedRecords:[],deletedRecords:[],changedRecords:[]},g=[];t?g=this.nodeType(t):i&&("string"==typeof i?g[0]=i.toString():"object"===s(i)&&(g[0]=i.getAttribute("data-uid").toString()));for(var b=0,v=g.length;b<v;b++){var N=this.getElement(g[b]);if(!sf.base.isNullOrUndefined(N)){var m=this.getNodeObject(g[b]);c.push(m)}}switch(e){case"delete":1==t.length?l=h.remove(p,c[0],f.fromTable,f):(u.deletedRecords=c,l=h.saveChanges(u,p,f.fromTable,f)),l.then((function(e){return o.deleteSuccess(g)})).catch((function(e){return o.dmFailure(e)}));break;case"update":c[0][this.fields.text]=a,(l=h.update(p,c[0],f.fromTable,f)).then((function(e){return o.editSucess(i,a,r)})).catch((function(e){return o.dmFailure(e,i,r)}));break;case"insert":if(1==n.length)l=h.insert(n[0],f.fromTable,f);else{var y=[];for(b=0,v=n.length;b<v;b++)y.push(n[b]);u.addedRecords=y,l=h.saveChanges(u,p,f.fromTable,f)}l.then((function(e){var t=o.getElement(i);o.addSuccess(n,t,d),o.preventExpand=!1})).catch((function(e){return o.dmFailure(e)}))}},t.prototype.deleteSuccess=function(e){for(var t=0,s=e.length;t<s;t++){var i=this.getElement(e[t]);sf.base.isNullOrUndefined(i)||this.removeNode(i)}1===this.dataType&&(this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)),this.triggerEvent()},t.prototype.editSucess=function(e,t,s){var i=this.getElement(e),a=sf.base.select("."+o,i);this.appendNewText(i,a,t,s)},t.prototype.addSuccess=function(e,t,s){var i,a=t?t.querySelector("."+g):null,n=this;t&&a&&a.classList.contains(r)&&null===t.querySelector("."+h)?n.renderChildNodes(t,null,(function(){i=t.querySelector("."+h),n.addGivenNodes(e,t,s,!0,i),n.triggerEvent()})):(this.addGivenNodes(e,t,s,!0),this.triggerEvent())},t.prototype.dmFailure=function(e,t,s){t&&this.updatePreviousText(t,s),this.trigger("actionFailure",{error:e})},t.prototype.updatePreviousText=function(e,t){var s=this.getElement(e),i=sf.base.select("."+o,s);this.updateText(s,i,this.oldText,t)},t.prototype.onPropertyChanged=function(e,t){for(var s=0,i=Object.keys(e);s<i.length;s++){switch(i[s]){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"dragArea":this.allowDragAndDrop&&(this.dragObj.dragArea=this.dragArea);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var a=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(a,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"checkedNodes":this.showCheckBox&&(this.checkedNodes=t.checkedNodes,this.setCheckedNodes(e.checkedNodes));break;case"autoCheck":this.showCheckBox&&(this.autoCheck=e.autoCheck,this.ensureIndeterminate());break;case"cssClass":this.setCssClass(t.cssClass,e.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandedNodes":this.isAnimate=!1,this.isBlazorPlatform||this.setProperties({expandedNodes:[]},!0),this.collapseAll(),this.isInitalExpand=!0,this.isBlazorPlatform||this.setProperties({expandedNodes:sf.base.isNullOrUndefined(e.expandedNodes)?[]:e.expandedNodes},!0),this.doExpandAction(),this.isInitalExpand=!1,this.isAnimate=!0;break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),"None"===this.expandOnType||this.disabled||this.wireExpandOnEvent(!0);break;case"disabled":this.setDisabledMode(),this.dynamicState();break;case"fields":this.isAnimate=!1,this.isFieldChange=!0,this.initialRender=!0,this.blazorInitialRender||this.reRenderNodes(),this.blazorInitialRender=!1,this.initialRender=!1,this.isAnimate=!0,this.isFieldChange=!1;break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect);break;case"loadOnDemand":if(!1===this.loadOnDemand&&!this.onLoaded){for(var n=this.element.querySelectorAll("li"),d=0;d<n.length;)"true"!==n[d].getAttribute("aria-expanded")&&this.renderChildNodes(n[d],!0,null,!0),d++;this.onLoaded=!0}break;case"nodeTemplate":this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:e.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":case"sortOrder":this.reRenderNodes();break;case"fullRowNavigable":this.setProperties({fullRowNavigable:e.fullRowNavigable},!0),this.listBaseOption.itemNavigable=e.fullRowNavigable,this.reRenderNodes()}}},t.prototype.destroy=function(){sf.base.resetBlazorTemplate(this.element.id+"nodeTemplate","NodeTemplate"),this.clearTemplate(),this.element.removeAttribute("aria-activedescendant"),this.element.removeAttribute("tabindex"),this.unWireEvents(),this.wireEditingEvents(!1),this.disabled||(this.rippleFn(),this.rippleIconFn()),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.isBlazorPlatform&&(this.ulElement=this.element.querySelector(".e-list-parent.e-ul")),this.ulElement&&this.ulElement.parentElement&&this.ulElement.parentElement.removeChild(this.ulElement),this.isBlazorPlatform||e.prototype.destroy.call(this)},t.prototype.addNodes=function(e,t,s,i){if(!sf.base.isNullOrUndefined(e)){e=JSON.parse(JSON.stringify(e));var a=this.getElement(t);if(this.preventExpand=i,this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName)this.isOffline?this.addSuccess(e,a,s):this.crudOperation("insert",null,t,null,e,s,this.preventExpand);else if(2===this.dataType)this.addGivenNodes(e,a,s);else{if(a)this.addGivenNodes(e,a,s);else{e=this.getSortedData(e);for(var n=0;n<e.length;n++){var d=sf.base.getValue(this.fields.parentID,e[n]);a=d?this.getElement(d.toString()):d,this.addGivenNodes([e[n]],a,s)}}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}this.showCheckBox&&a&&this.ensureParentCheckState(a),(this.fields.dataSource instanceof sf.data.DataManager==!1||this.fields.dataSource instanceof sf.data.DataManager&&"BlazorAdaptor"===this.fields.dataSource.adaptorName)&&(this.preventExpand=!1,this.triggerEvent())}},t.prototype.beginEdit=function(e){var t=this.getElement(e);sf.base.isNullOrUndefined(t)||this.disabled||this.createTextbox(t,null)},t.prototype.checkAll=function(e){this.showCheckBox&&this.doCheckBoxAction(e,!0)},t.prototype.collapseAll=function(e,t,s){sf.base.isNullOrUndefined(e)?t>0?this.collapseByLevel(sf.base.select("."+h,this.element),t,s):this.collapseAllNodes(s):this.doGivenAction(e,d,!1)},t.prototype.disableNodes=function(e){sf.base.isNullOrUndefined(e)||this.doDisableAction(e)},t.prototype.enableNodes=function(e){sf.base.isNullOrUndefined(e)||this.doEnableAction(e)},t.prototype.ensureVisible=function(e){var t=this.getElement(e);if(!sf.base.isNullOrUndefined(t)){var s=this.parents(t,"."+l);this.expandAll(s),setTimeout((function(){t.scrollIntoView(!0)}),450)}},t.prototype.expandAll=function(e,t,s){sf.base.isNullOrUndefined(e)?t>0?this.expandByLevel(sf.base.select("."+h,this.element),t,s):this.expandAllNodes(s):this.doGivenAction(e,r,!0)},t.prototype.getAllCheckedNodes=function(){return this.checkedNodes},t.prototype.getDisabledNodes=function(){return this.disableNode},t.prototype.getNode=function(e){var t=this.getElement(e);return this.getNodeData(t,!0)},t.prototype.getTreeData=function(e){var t=this.getId(e);if(this.updatePersistProp(),sf.base.isNullOrUndefined(t))return this.treeData;var s=this.getNodeObject(t);return sf.base.isNullOrUndefined(s)?[]:[s]},t.prototype.moveNodes=function(e,t,s,i){var a=this.getElement(t);if(!sf.base.isNullOrUndefined(a)){for(var n=0;n<e.length;n++){var d=this.getElement(e[n]);sf.base.isNullOrUndefined(d)||a.isSameNode(d)||this.isDescendant(d,a)||(this.preventExpand=i,this.dropAsChildNode(d,a,this,s))}this.fields.dataSource instanceof sf.data.DataManager==!1&&(this.preventExpand=!1),this.triggerEvent()}},t.prototype.refreshNode=function(e,t){if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)){var s,i=!1;if(1==this.dataType&&t.length>1)i=!0;else if(2==this.dataType&&1===t.length){var a=sf.base.getValue(this.fields.child.toString(),t[0]);sf.base.isNullOrUndefined(a)||(i=!0)}var n,l,o=this.getElement(e);if(s=o?o.getAttribute("data-uid"):e?e.toString():null,this.refreshData=this.getNodeObject(s),t=JSON.parse(JSON.stringify(t)),1==this.dataType&&i){for(var c=0;c<t.length;c++)if(sf.base.isNullOrUndefined(t[c][this.fields.parentID])){l=t[c],t.splice(c,1);break}n=sf.base.extend({},this.refreshData,l)}else n=sf.base.extend({},this.refreshData,t[0]);if(sf.base.isNullOrUndefined(o))this.updatePosition(s,n,i,t);else{this.isRefreshed=!0;var f=parseFloat(o.getAttribute("aria-level")),p=sf.lists.ListBase.createListItemFromJson(this.createElement,[n],this.listBaseOption,f),u=sf.base.select("."+h,o),v=sf.base.getValue(this.fields.child.toString(),n);if(i&&u||i&&!sf.base.isNullOrUndefined(v))o.innerHTML=p[0].innerHTML,this.updatePosition(s,n,i,t),i&&u&&this.expandAll([s]);else{var N=sf.base.select("."+b,o),m=sf.base.select("."+b,p[0]),y=sf.base.select("div."+g,N),C=sf.base.select("div."+g,m);y&&C&&(C.classList.contains(r)&&y.classList.contains(d)?(sf.base.removeClass([C],r),sf.base.addClass([C],d)):C.classList.contains(d)&&y.classList.contains(r)?(sf.base.removeClass([C],d),sf.base.addClass([C],r)):y.classList.contains("interaction")&&sf.base.addClass([C],"interaction")),N.innerHTML=m.innerHTML,this.updatePosition(s,n,i,t)}if(n[this.fields.tooltip]&&o.setAttribute("title",n[this.fields.tooltip]),n.hasOwnProperty(this.fields.htmlAttributes)&&n[this.fields.htmlAttributes]){var k={};sf.base.merge(k,n[this.fields.htmlAttributes]),k.class?(sf.base.addClass([o],k.class.split(" ")),delete k.class):sf.base.attributes(o,k)}this.isRefreshed=!1,this.triggerEvent()}}},t.prototype.removeNodes=function(e){sf.base.isNullOrUndefined(e)||(this.fields.dataSource instanceof sf.data.DataManager&&!this.isOffline&&"BlazorAdaptor"!==this.fields.dataSource.adaptorName?this.crudOperation("delete",e):this.deleteSuccess(e))},t.prototype.updateNode=function(e,t){var s=this;if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&this.allowEditing){var i=this.getElement(e);if(!sf.base.isNullOrUndefined(i)){var a=sf.base.select("."+o,i);this.updateOldText(i);var n=this.getEditEvent(i,null,null);this.trigger("nodeEditing",n,(function(n){n.cancel||(s.fields.dataSource instanceof sf.data.DataManager&&!s.isOffline&&"BlazorAdaptor"!==s.fields.dataSource.adaptorName?s.crudOperation("update",null,e,t,null,null,!1):s.appendNewText(i,a,t,!1))}))}}},t.prototype.uncheckAll=function(e){this.showCheckBox&&this.doCheckBoxAction(e,!1)},a([sf.base.Property(!1)],t.prototype,"allowDragAndDrop",void 0),a([sf.base.Property(!1)],t.prototype,"allowEditing",void 0),a([sf.base.Property(!1)],t.prototype,"allowMultiSelection",void 0),a([sf.base.Complex({},D)],t.prototype,"animation",void 0),a([sf.base.Property()],t.prototype,"checkedNodes",void 0),a([sf.base.Property("")],t.prototype,"cssClass",void 0),a([sf.base.Property(!1)],t.prototype,"disabled",void 0),a([sf.base.Property(null)],t.prototype,"dragArea",void 0),a([sf.base.Property(!1)],t.prototype,"enableHtmlSanitizer",void 0),a([sf.base.Property(!1)],t.prototype,"enablePersistence",void 0),a([sf.base.Property()],t.prototype,"expandedNodes",void 0),a([sf.base.Property("Auto")],t.prototype,"expandOn",void 0),a([sf.base.Complex({},S)],t.prototype,"fields",void 0),a([sf.base.Property(!0)],t.prototype,"fullRowSelect",void 0),a([sf.base.Property(!0)],t.prototype,"loadOnDemand",void 0),a([sf.base.Property()],t.prototype,"locale",void 0),a([sf.base.Property()],t.prototype,"nodeTemplate",void 0),a([sf.base.Property()],t.prototype,"selectedNodes",void 0),a([sf.base.Property("None")],t.prototype,"sortOrder",void 0),a([sf.base.Property(!1)],t.prototype,"showCheckBox",void 0),a([sf.base.Property(!0)],t.prototype,"autoCheck",void 0),a([sf.base.Property(!1)],t.prototype,"fullRowNavigable",void 0),a([sf.base.Event()],t.prototype,"actionFailure",void 0),a([sf.base.Event()],t.prototype,"created",void 0),a([sf.base.Event()],t.prototype,"dataBound",void 0),a([sf.base.Event()],t.prototype,"dataSourceChanged",void 0),a([sf.base.Event()],t.prototype,"drawNode",void 0),a([sf.base.Event()],t.prototype,"destroyed",void 0),a([sf.base.Event()],t.prototype,"keyPress",void 0),a([sf.base.Event()],t.prototype,"nodeChecked",void 0),a([sf.base.Event()],t.prototype,"nodeChecking",void 0),a([sf.base.Event()],t.prototype,"nodeClicked",void 0),a([sf.base.Event()],t.prototype,"nodeCollapsed",void 0),a([sf.base.Event()],t.prototype,"nodeCollapsing",void 0),a([sf.base.Event()],t.prototype,"nodeDragging",void 0),a([sf.base.Event()],t.prototype,"nodeDragStart",void 0),a([sf.base.Event()],t.prototype,"nodeDragStop",void 0),a([sf.base.Event()],t.prototype,"nodeDropped",void 0),a([sf.base.Event()],t.prototype,"nodeEdited",void 0),a([sf.base.Event()],t.prototype,"nodeEditing",void 0),a([sf.base.Event()],t.prototype,"nodeExpanded",void 0),a([sf.base.Event()],t.prototype,"nodeExpanding",void 0),a([sf.base.Event()],t.prototype,"nodeSelected",void 0),a([sf.base.Event()],t.prototype,"nodeSelecting",void 0),t=O=a([sf.base.NotifyPropertyChanges],t)}(sf.base.Component);return e.FieldsSettings=S,e.ActionSettings=O,e.NodeAnimationSettings=D,e.TreeView=E,e}({}))}});